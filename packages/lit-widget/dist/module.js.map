{"version":3,"file":"module.js","sources":["../src/lit-widget-base.js","../src/tools/debounce.js","../src/tools/listeners-map.js","../src/controllers/events-controller.js","../src/controllers/shared-styles-controller.js","../src/lit-widget.js","../src/decorators.js"],"sourcesContent":["import { LitElement } from 'lit';\r\n\r\nexport class LitWidgetBase extends LitElement {\r\n\r\n  get targetAttribute() {\r\n    return 'data-target';\r\n  }\r\n\r\n  get targetsAttribute() {\r\n    return 'data-targets';\r\n  }\r\n\r\n  createTargetPath(tagName, targetName) {\r\n    const tag = tagName.toLowerCase();\r\n    return `${tag}.${targetName}`;\r\n  }\r\n\r\n  createTargetSelector(tagName, targetName) {\r\n    const tag = tagName.toLowerCase();\r\n    return `[${this.targetAttribute}~=\"${tag}.${targetName}\"]`;\r\n  }\r\n\r\n  createTargetsSelector(tagName, targetName) {\r\n    const tag = tagName.toLowerCase();\r\n    return `[${this.targetsAttribute}~=\"${tag}.${targetName}\"]`;\r\n  }\r\n\r\n  targetMatches(el, tagName, targetName) {\r\n    const selector = this.createTargetSelector(tagName, targetName);\r\n    return el.matches(selector);\r\n  }\r\n\r\n  targetsMatches(el, tagName, targetName) {\r\n    const selector = this.createTargetsSelector(tagName, targetName);\r\n    return el.matches(selector);\r\n  }\r\n\r\n  /**\r\n   * findTarget will run `querySelectorAll` against the given widget element, plus\r\n   * its shadowRoot, returning any the first child that:\r\n   *\r\n   *  - Matches the selector of `[data-target~=\"tag.name\"]` where tag is the\r\n   *    tagName of the HTMLElement, and `name` is the given `targetName` argument.\r\n   *\r\n   *  - Closest ascendant of the element, that matches the tagname of the\r\n   *    widget, is the specific instance of the widget itself - in other\r\n   *    words it is not nested in other widgets of the same type.\r\n   *\r\n   * @param {string} tagName - HTML element tag name\r\n   * @param {string} targetName - Widget property name\r\n   * @param {string} [selector] - Selector to find element instead of using [data-target]\r\n   * @param {Function} [converter] - The result converter can be used to convert the tag, for example using templateContent\r\n   * @returns {(HTMLElement|any|null)} The HTML element found, or null if no matching element was found\r\n   */\r\n  findTarget(tagName, targetName, selector = null, converter = null) {\r\n    let convert = (value) => !!converter ? converter(value) : value;\r\n    const tag = tagName.toLowerCase();\r\n\r\n    if (!!selector) {\r\n      for (const el of this.querySelectorAll(selector)) {\r\n        if (el.closest(tag) === this) {\r\n          return convert(el);\r\n        }\r\n      }\r\n    }\r\n\r\n    const targetSelector = this.createTargetSelector(tag, targetName);\r\n\r\n    if (this.shadowRoot) {\r\n      for (const el of this.shadowRoot.querySelectorAll(targetSelector)) {\r\n        if (!el.closest(tag)) return convert(el);\r\n      }\r\n    }\r\n\r\n    for (const el of this.querySelectorAll(targetSelector)) {\r\n      if (el.closest(tag) === this) return convert(el);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * findTargets will run `querySelectorAll` against the given widget element, plus\r\n   * its shadowRoot, returning all matching child elements that are:\r\n   *\r\n   *  - Matches the selector of `[data-targets~=\"tag.name\"]` where tag is the\r\n   *    tagName of the HTMLElement, and `name` is the given `targetName` argument.\r\n   *\r\n   *  - Closest ascendant of the element, that matches the tagname of the\r\n   *    widget, is the specific instance of the widget itself - in other\r\n   *    words it is not nested in other widgets of the same type.\r\n   *\r\n   * @param {string} tagName - HTML element tag name\r\n   * @param {string} targetName - Widget property name\r\n   * @param {string} [selector] - Selector to find elements instead of using [data-targets]\r\n   * @param {Function} [converter] - The result converter can be used to convert the result tags, for example using templateContent\r\n   * @returns {HTMLElement[]} The HTML elements found\r\n   */\r\n  findTargets(tagName, targetName, selector = null, converter = null) {\r\n    let convert = (value) => !!converter ? converter(value) : value;\r\n    const tag = tagName.toLowerCase();\r\n    const targets = [];\r\n\r\n    if (!!selector) {\r\n      for (const el of this.querySelectorAll(selector)) {\r\n        if (el.closest(tag) === this) {\r\n          targets.push(convert(el));\r\n        }\r\n      }\r\n    }\r\n\r\n    const targetsSelector = this.createTargetsSelector(tag, targetName);\r\n\r\n    if (this.shadowRoot) {\r\n      for (const el of this.shadowRoot.querySelectorAll(targetsSelector)) {\r\n        if (!el.closest(tag)) {\r\n          targets.push(convert(el));\r\n        }\r\n      }\r\n    }\r\n\r\n    for (const el of this.querySelectorAll(targetsSelector)) {\r\n      if (el.closest(tag) === this) {\r\n        targets.push(convert(el));\r\n      }\r\n    }\r\n\r\n    return targets;\r\n  }\r\n\r\n}\r\n","/**\r\n * Throttle the execution of the function.\r\n *\r\n * You can specify the value in milliseconds as a number or in string format\r\n * with the suffix `'<delay>ms'`, supported suffixes: ms - milliseconds, s - seconds, m - minutes.\r\n *\r\n * This can be handy for \"resize\" or \"scroll\" events.\r\n *\r\n * @param {function} fn - The function to throttle.\r\n * @param {(Number|string)} delay - Delay value.\r\n * @returns {Function} The new throttled function.\r\n */\r\nexport function throttle(fn, delay) {\r\n  let throttlePause;\r\n\r\n  function throttler(...args) {\r\n    if (throttlePause) return;\r\n    throttlePause = true;\r\n\r\n    setTimeout(() => {\r\n      fn.apply(this, args);\r\n      throttlePause = false;\r\n    }, duration(delay));\r\n  }\r\n\r\n  return throttler;\r\n}\r\n\r\n/**\r\n * Debounce the execution of the function.\r\n *\r\n * You can specify the value in milliseconds as a number or in string format\r\n * with the suffix `'<delay>ms'`, supported suffixes: ms - milliseconds, s - seconds, m - minutes.\r\n *\r\n * This can be handy for events such as key presses or \"input\" in input fields.\r\n *\r\n * @param {function} fn - The function to debounce.\r\n * @param {(Number|string)} delay - Delay value.\r\n * @returns {Function} The new debounced function.\r\n */\r\nexport function debounce(fn, delay) {\r\n  let timeoutId;\r\n\r\n  function debouncer(...args) {\r\n    debouncer.clear();\r\n\r\n    timeoutId = setTimeout(() => {\r\n      timeoutId = null;\r\n\r\n      fn.apply(this, args);\r\n    }, duration(delay));\r\n  }\r\n\r\n  debouncer.clear = function() {\r\n    if (timeoutId) {\r\n      clearTimeout(timeoutId);\r\n      timeoutId = null;\r\n    }\r\n  }\r\n\r\n  return debouncer;\r\n}\r\n\r\n/**\r\n * Duration converter from human-readable form to milliseconds.\r\n *\r\n * Converts a string like `'<delay>ms'` to milliseconds.\r\n * Supported suffixes: ms - milliseconds, s - seconds, m - minutes.\r\n *\r\n * If a numeric value is passed, it is returned unchanged.\r\n *\r\n * @param {(string|Number)} value - Duration in human-readable form.\r\n * @returns {Number} - Value in milliseconds.\r\n */\r\nexport function duration(value) {\r\n  if (typeof value === 'number') {\r\n    return value;\r\n  }\r\n  if (typeof value !== 'string') {\r\n    throw new Error(`Invalid duration \"${value}\".`);\r\n  }\r\n\r\n  const duration = parseFloat(value);\r\n  if (isNaN(duration)) {\r\n    throw new Error(`Invalid duration value \"${value}\".`);\r\n  }\r\n\r\n  if (value.endsWith('ms')) {\r\n    return duration;\r\n  }\r\n  if (value.endsWith('s')) {\r\n    return duration * 1000;\r\n  }\r\n  if (value.endsWith('m')) {\r\n    return duration * 1000 * 60;\r\n  }\r\n}\r\n","\r\nexport class ListenersMap {\r\n\r\n\t#map;\r\n\r\n\tconstructor() {\r\n  \tthis.#map = new Map();\r\n  }\r\n\r\n  #normalizeKey(key) {\r\n  \treturn JSON.stringify(key);\r\n    //return key;\r\n  }\r\n\r\n  has(el, key) {\r\n  \tif (!this.#map.has(el)) return false;\r\n    return this.#map.get(el).has(this.#normalizeKey(key));\r\n  }\r\n\r\n  get(el, key) {\r\n  \tif (!this.#map.has(el)) return null;\r\n    return this.#map.get(el).get(this.#normalizeKey(key));\r\n  }\r\n\r\n  set(el, key, value) {\r\n  \tconst listeners = this.#map.get(el) || new Map();\r\n\t\tconst normalizedKey = this.#normalizeKey(key);\r\n    listeners.set(normalizedKey, value);\r\n    this.#map.set(el, listeners);\r\n  }\r\n\r\n  delete(el, key) {\r\n  \tif (!this.#map.has(el)) return null;\r\n    return this.#map.get(el).delete(this.#normalizeKey(key));\r\n  }\r\n\r\n  clear() {\r\n    this.#map = new Map();\r\n  }\r\n\r\n  *[Symbol.iterator]() {\r\n  \tfor (const [el, listeners] of this.#map) {\r\n    \tfor (const [key, listener] of listeners) {\r\n      \tyield [el, key, listener];\r\n      }\r\n    }\r\n  }\r\n\r\n}\r\n\r\n","import { LitWidgetBase } from '../lit-widget-base';\r\nimport { throttle, debounce } from '../tools/debounce';\r\nimport { ListenersMap } from '../tools/listeners-map';\r\n\r\nclass EventHandler {\r\n\r\n  constructor(eventName, handler) {\r\n    this.eventName = eventName;\r\n    this.handler = handler;\r\n  }\r\n\r\n  addListener(el) {\r\n    el.addEventListener(this.eventName, this.handler);\r\n  }\r\n\r\n  removeListener(el) {\r\n    el.removeEventListener(this.eventName, this.handler);\r\n  }\r\n\r\n}\r\n\r\n/**\r\n * TODO:\r\n */\r\nexport class EventsController {\r\n\r\n  host;\r\n\r\n  observer;\r\n\r\n  listeners = new ListenersMap();\r\n\r\n  constructor(host, events) {\r\n    if (!(host instanceof LitWidgetBase)) {\r\n      throw new Error('[LitWidget.EventsController]: The host is not an instance of the LitWidget class.');\r\n    }\r\n\r\n    this.host = host;\r\n    this.tagName = this.host.tagName.toLowerCase();\r\n    this.events = this.prepareEvents(events);\r\n\r\n    // console.log('Events:', this.events);\r\n\r\n    this.host.addController(this);\r\n  }\r\n\r\n  prepareEvents(events) {\r\n    let targetedEvents = new Map();\r\n\r\n    for (const event of events) {\r\n      let target;\r\n      if ((event.target instanceof HTMLElement) || (event.target instanceof Document) || (event.target instanceof Window)) {\r\n        target = {type: 'element', element: event.target};\r\n      } else {\r\n        if (typeof event.target === 'string') {\r\n          target = {type: 'target', target: event.target, selector: event.selector};\r\n        } else {\r\n          throw new Error(`[LitWidget.EventsController]: Invalid event definition: ${JSON.stringify(event)}.`);\r\n        }\r\n      }\r\n\r\n      targetedEvents.set(target, event);\r\n    }\r\n\r\n    // console.log('Targeted events:', targetedEvents);\r\n\r\n    return targetedEvents;\r\n  }\r\n\r\n  hostConnected() {\r\n    // console.log('[!] EventsController connected');\r\n\r\n    // Bind [type=element] events to elements\r\n    this.bindElementsEvents();\r\n\r\n    // Bind element events to targets\r\n    this.bindTargetElements(this.host);\r\n\r\n    // Observe shadowRoot and element\r\n    this.listen([this.host.shadowRoot, this.host]);\r\n  }\r\n\r\n  hostDisconnected() {\r\n    // console.log('[!] EventsController disconnected');\r\n\r\n    // Disconnect observer\r\n    this.observer?.disconnect();\r\n    this.observer = null;\r\n\r\n    // Remove elements listeners\r\n    for (const [element, target, handler] of this.listeners) {\r\n      handler.removeListener(element);\r\n    }\r\n    this.listeners.clear();\r\n  }\r\n\r\n  createHandler(event) {\r\n    // Event name\r\n    let eventName = event.event;\r\n\r\n    // Add listeners if attribute added\r\n    let handler = (...args) => event.handler.apply(this.host, args);\r\n\r\n    // Handling debounce, etc...\r\n    if (event.debounce) {\r\n      handler = debounce(handler, event.debounce);\r\n    } else if (event.throttle) {\r\n      handler = throttle(handler, event.throttle);\r\n    }\r\n    if (event['wrapper'] != null && typeof event['wrapper'] !== 'undefined') {\r\n      handler = event.wrapper.call(this.host, handler/*, this.host*/);\r\n    }\r\n\r\n    // Handling delegated event\r\n    if (typeof event.selector == 'string') {\r\n      handler = (() => {\r\n        const prevHandler = handler;\r\n        return (e) => {\r\n          if (e.target.matches(event.selector)) {\r\n            prevHandler(e);\r\n          }\r\n        };\r\n      })();\r\n    }\r\n\r\n    // Handle conditional event (eventName = {eventHandler: string, isMatch: function})\r\n    if (typeof eventName == 'object') {\r\n      const preset = eventName;\r\n      if ((preset.eventName == null) || (typeof preset.isMatch !== 'function')) {\r\n        throw new Error(`[LitWidget.EventsController]: Invalid conditional event: ${preset}`);\r\n      }\r\n\r\n      // Extract eventName from preset\r\n      eventName = preset.eventName;\r\n\r\n      // Wrap handler\r\n      handler = (() => {\r\n        const isMatch = preset.isMatch;\r\n        const prevHandler = handler;\r\n        return (e) => {\r\n          if (isMatch(e)) {\r\n            prevHandler(e);\r\n          }\r\n        };\r\n      })();\r\n\r\n    }\r\n\r\n    // Create event handler\r\n    const eventHandler = new EventHandler(eventName, handler);\r\n\r\n    return eventHandler;\r\n  }\r\n\r\n  bindElementsEvents() {\r\n    for (const [eventInfo, event] of this.events) {\r\n      if (eventInfo.type !== 'element') continue;\r\n\r\n      const key = {element: eventInfo.element, target: eventInfo};\r\n      if (this.listeners.has(eventInfo.element, key)) continue;\r\n\r\n      // Create event handler\r\n      const eventHandler = this.createHandler(event);\r\n\r\n      // Add listener to element\r\n      eventHandler.addListener(eventInfo.element);\r\n\r\n      // Store element's event handler\r\n      this.listeners.set(eventInfo.element, key, eventHandler);\r\n    }\r\n  }\r\n\r\n  bindEvents(el, oldAttrValue) {\r\n    // console.log('Bind actions:', el);\r\n\r\n    // for (const event of this.events) {\r\n    for (const [eventInfo, event] of this.events) {\r\n      if (eventInfo.type !== 'target') continue;\r\n\r\n      const isMatch = this.host.targetMatches(el, this.tagName, eventInfo.target) || this.host.targetsMatches(el, this.tagName, eventInfo.target);\r\n      const isOldMatch = !isMatch && (oldAttrValue == this.host.createTargetPath(this.tagName, eventInfo.target));\r\n      const key = {element: el, id: event.id};\r\n\r\n      if (isMatch) {\r\n        if (this.listeners.has(el, key)) continue;\r\n\r\n        // console.log('Bind [3] (+):', key, el, event);\r\n\r\n        // Skip nested (Shadow DOM Only!)\r\n        const isShadowNode = el.getRootNode() === this.host.shadowRoot;\r\n        if (isShadowNode && el.closest(this.tagName)) continue;\r\n\r\n        // Create event handler\r\n        const eventHandler = this.createHandler(event);\r\n\r\n        // Add listener to element\r\n        eventHandler.addListener(el);\r\n\r\n        // Store element's event handler\r\n        this.listeners.set(el, key, eventHandler);\r\n      } else if (isOldMatch) {\r\n        if (!this.listeners.has(el, key)) continue;\r\n\r\n        // console.log('Bind [3] (-):', key, el, event);\r\n\r\n        // Remove listeners if attribute removed\r\n        const handler = this.listeners.get(el, key);\r\n        handler?.removeListener(el);\r\n\r\n        // Remove element from listeners map\r\n        this.listeners.delete(el, key);\r\n      }\r\n    }\r\n  }\r\n\r\n  bindTargetElements(root) {\r\n    // Bind controller's targets\r\n    for (const el of root.querySelectorAll(`[${this.host.targetAttribute}],[${this.host.targetsAttribute}]`)) {\r\n      this.bindEvents(el);\r\n    }\r\n\r\n    // Also bind the controller to itself\r\n    if (root instanceof Element && (root.hasAttribute(this.host.targetAttribute) || root.hasAttribute(this.host.targetsAttribute))) {\r\n      this.bindEvents(root);\r\n    }\r\n  }\r\n\r\n  listen(els) {\r\n    if (!this.observer) {\r\n      // Create observer\r\n      this.observer = new MutationObserver(mutations => {\r\n        for (const mutation of mutations) {\r\n          if (mutation.type === 'attributes' && mutation.target instanceof Element) {\r\n            this.bindEvents(mutation.target, mutation.oldValue);\r\n          } else if (mutation.type === 'childList' && mutation.addedNodes.length) {\r\n            for (const node of mutation.addedNodes) {\r\n              if (node instanceof Element) {\r\n                this.bindTargetElements(node);\r\n              }\r\n            }\r\n          }\r\n        }\r\n      });\r\n    }\r\n\r\n    // Observe elements\r\n    for (const el of els) {\r\n      if (el == null) continue;\r\n\r\n      this.observer.observe(\r\n        el,\r\n        {\r\n          childList: true,\r\n          subtree: true,\r\n          attributeFilter: [\r\n            this.host.targetAttribute,\r\n            this.host.targetsAttribute,\r\n          ],\r\n          attributeOldValue : true,\r\n        }\r\n      );\r\n    }\r\n  }\r\n\r\n}\r\n","\r\nclass DocumentStylesObserver {\r\n\r\n  document;\r\n\r\n  observer;\r\n\r\n  observing;\r\n\r\n  listeners;\r\n\r\n  constructor(document) {\r\n    this.document = document;\r\n    this.listeners = new Set();\r\n    this.observing = false;\r\n\r\n    this.observer = new MutationObserver(mutations => {\r\n      for (const mutation of mutations) {\r\n        if (mutation.type === 'childList' && (mutation.addedNodes.length || mutation.removedNodes.length)) {\r\n          // console.log('! [+]', mutation.addedNodes);\r\n          // console.log('! [-]', mutation.removedNodes);\r\n\r\n          for (const node of mutation.addedNodes) {\r\n            if (node instanceof Element) {\r\n              const tagName = node.tagName.toLowerCase();\r\n              if ((tagName == 'style') || (tagName == 'link' && node.getAttribute('rel') == 'stylesheet')) {\r\n                this.notifyListeners({type: 'add', node});\r\n              }\r\n            }\r\n          }\r\n\r\n          for (const node of mutation.removedNodes) {\r\n            if (node instanceof Element) {\r\n              const tagName = node.tagName.toLowerCase();\r\n              if ((tagName == 'style') || (tagName == 'link' && node.getAttribute('rel') == 'stylesheet')) {\r\n                this.notifyListeners({type: 'remove', node});\r\n              }\r\n            }\r\n          }\r\n\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  observe() {\r\n    if (this.observing) return;\r\n\r\n    this.observer.observe(\r\n      this.document.head,\r\n      {\r\n        childList: true,\r\n        subtree: true,\r\n      }\r\n    );\r\n\r\n    this.observing = true;\r\n  }\r\n\r\n  disconnect() {\r\n    if (!this.observing) return;\r\n\r\n    this.observer.takeRecords();\r\n    this.observer.disconnect();\r\n\r\n    this.observing = false;\r\n  }\r\n\r\n  addListener(fn) {\r\n    this.listeners.add(fn);\r\n    if (this.listeners.size > 0) {\r\n      this.observe();\r\n    }\r\n  }\r\n\r\n  removeListener(fn) {\r\n    this.listeners.delete(fn);\r\n    if (this.listeners.size == 0) {\r\n      this.disconnect();\r\n    }\r\n  }\r\n\r\n  notifyListeners(operation) {\r\n    for (const listener of this.listeners) {\r\n      listener(operation);\r\n    }\r\n  }\r\n\r\n}\r\n\r\n/**\r\n * TODO:\r\n */\r\nexport class SharedStylesController {\r\n\r\n  host;\r\n\r\n  static observer;\r\n\r\n  initialized = false;\r\n\r\n  styleRoot;\r\n  styles = new WeakMap();\r\n\r\n  constructor(host, sharedStyles) {\r\n    if (sharedStyles) {\r\n      this.host = host;\r\n      this.host.addController(this);\r\n      this.stylesUpdated = (o) => this.updated(o);\r\n    }\r\n  }\r\n\r\n  hostConnected() {\r\n    const shadowRoot = this.host.shadowRoot != null;\r\n\r\n    if (!this.initialized) {\r\n      this.initialized = true;\r\n\r\n      const root = this.host.renderRoot;\r\n      const document = this.host.ownerDocument;\r\n\r\n      if (shadowRoot) {\r\n        // Import styles\r\n        for (const style of document.head.querySelectorAll('style')) {\r\n          this.addStyle(style, root);\r\n        }\r\n\r\n        // Import link[stylesheet]\r\n        for (const style of document.head.querySelectorAll('link[rel=\"stylesheet\"]')) {\r\n          this.addStyle(style, root);\r\n        }\r\n      }\r\n    }\r\n\r\n    if (shadowRoot) {\r\n      this.startObserving();\r\n    }\r\n  }\r\n\r\n  addStyle(style, root = null) {\r\n    // Skip non-shared styles\r\n    if (style.getAttribute('data-shared') == 'false') return;\r\n\r\n    if (root == null) root = this.host.renderRoot;\r\n\r\n    // Create styleRoot\r\n    if (this.styleRoot == null) {\r\n      this.styleRoot = this.host.ownerDocument.createElement('shared-styles--');\r\n      root.insertBefore(this.styleRoot, root.firstChild);\r\n    }\r\n\r\n    // Cloning and adding a style\r\n    const styleClone = style.cloneNode(true);\r\n    this.styleRoot.appendChild(styleClone);\r\n\r\n    // Save the link between the style and its clone\r\n    this.styles.set(style, styleClone);\r\n  }\r\n\r\n  removeStyle(style) {\r\n    const styleClone = this.styles.get(style);\r\n    if (styleClone != null) {\r\n      styleClone.remove();\r\n      this.styles.delete(style);\r\n    }\r\n  }\r\n\r\n  hostDisconnected() {\r\n    this.stopObserving();\r\n  }\r\n\r\n  startObserving() {\r\n    // Create observer\r\n    if (SharedStylesController.observer == null) {\r\n      SharedStylesController.observer = new DocumentStylesObserver(this.host.ownerDocument);\r\n    }\r\n\r\n    // Start observing\r\n    SharedStylesController.observer.addListener(this.stylesUpdated);\r\n  }\r\n\r\n  stopObserving() {\r\n    if (SharedStylesController.observer != null) {\r\n      SharedStylesController.observer.removeListener(this.stylesUpdated);\r\n    }\r\n  }\r\n\r\n  updated({type, node}) {\r\n    switch(type) {\r\n      case 'add':\r\n        this.addStyle(node);\r\n        break;\r\n\r\n      case 'remove':\r\n        this.removeStyle(node);\r\n        break;\r\n    }\r\n  }\r\n\r\n}\r\n","import { html } from 'lit';\r\nimport { templateContent } from 'lit/directives/template-content.js';\r\nimport { EventsController } from './controllers/events-controller';\r\nimport { SharedStylesController } from './controllers/shared-styles-controller';\r\nimport { LitWidgetBase } from './lit-widget-base';\r\n\r\n/**\r\n * Declarative binding to child elements for [LitElement](https://lit.dev/)\r\n * like [Github/Catalyst](https://catalyst.rocks/) and\r\n * [Stimulus.js](https://stimulus.hotwired.dev/).\r\n *\r\n * To define a widget, subclass LitWidget, specify targets using\r\n * the `@target/@targets` decorators or the `static targets/targetsAll` property,\r\n * and add event handlers using the `@onEvent` decorator or\r\n * the `events` property.\r\n *\r\n * LitWidget unlike LitElement implements the **`render()`** method,\r\n * which renders all child elements of the widget through `<slot>`.\r\n * To change this behavior, simply override the `render` method and\r\n * implement your own rendering.\r\n *\r\n */\r\nexport class LitWidget extends LitWidgetBase {\r\n\r\n  // #region Static helpers\r\n\r\n  /** @internal */\r\n  static widget(name) {\r\n    return function(proto, options) {\r\n      LitWidget.define(name, proto, options);\r\n    }\r\n  }\r\n\r\n  /** @internal */\r\n  static define(name, constructor, options) {\r\n    customElements.define('w-' + name, constructor, options);\r\n  }\r\n\r\n  /**\r\n   * Getter helper, for getting static properties\r\n   */\r\n\tget static() {\r\n    return Object.getPrototypeOf(this).constructor;\r\n  }\r\n\r\n  // #endregion Static helpers\r\n\r\n  // #region Default render\r\n\r\n  /**\r\n   * Default renderer, renders Light DOM\r\n   */\r\n  render() {\r\n    return html`<slot></slot>`;\r\n  }\r\n\r\n  // #endregion Default render\r\n\r\n  // #region Default values\r\n\r\n  static defaultValues = {}\r\n\r\n  get defaultValues() {\r\n    if (this._defaultValues != null) {\r\n      return this._defaultValues;\r\n    }\r\n\r\n    // const parentDefaultValues = (this instanceof LitWidget) ? {} : Object.getPrototypeOf(this).defaultValues;\r\n    const parentDefaultValues = Object.getPrototypeOf(this).defaultValues ?? {};\r\n    this._defaultValues = {\r\n      ...parentDefaultValues,\r\n      ...this.constructor.defaultValues,\r\n    };\r\n\r\n    return this._defaultValues;\r\n  }\r\n\r\n  // #endregion Default values\r\n\r\n  // #region Events\r\n\r\n  #events;\r\n\r\n  #prepareEvents() {\r\n    const events = [\r\n      ...(this._events || []),\r\n      ...(this.events || []),\r\n    ];\r\n\r\n  \tconst eventsDefs = events.map((event, index) => {\r\n      return {id: index, ...event};\r\n    });\r\n\r\n    // Seal events\r\n    Object.defineProperty(this, 'events', {\r\n    \tconfigurable: true,\r\n      get() {\r\n      \treturn eventsDefs;\r\n      },\r\n    });\r\n  }\r\n\r\n  // #endregion Events\r\n\r\n  // #region Shared styles\r\n\r\n  /**\r\n   * Specifies whether to import page styles into shadowRoot.\r\n   */\r\n  static sharedStyles = null\r\n\r\n  /**\r\n   * @internal\r\n   */\r\n  get sharedStyles() {\r\n    let sharedStyles = this.static.sharedStyles;\r\n\r\n    // Treat null as auto\r\n    if ((sharedStyles == null) && !this.lightDOM) {\r\n      // If sharedStyles is \"auto\" and not lightDOM - then it will default to true\r\n      sharedStyles = true;\r\n    }\r\n\r\n    return sharedStyles;\r\n  }\r\n\r\n  #sharedStylesController = new SharedStylesController(this, this.sharedStyles);\r\n\r\n  // #endregion Shared styles\r\n\r\n  // #region Light DOM\r\n\r\n  /**\r\n   * Enables the use of Light DOM in the component.\r\n   *\r\n   * The renderRoot will be the component element or its child element\r\n   * with the `data-root=\"component-tag-name\"` attribute.\r\n   *\r\n   * @type {boolean}\r\n   */\r\n  static lightDOM = false\r\n\r\n  /**\r\n   * @internal\r\n   */\r\n  get lightDOM() {\r\n    return this.static.lightDOM;\r\n  }\r\n\r\n  createRenderRoot() {\r\n    let root;\r\n    const tagName = this.tagName.toLowerCase();\r\n\r\n    if (this.lightDOM) {\r\n      // Find light DOM root [data-root]\r\n      let rootElement = this.querySelector(`[data-root=\"${tagName}\"]`);\r\n\r\n      // If the nearest root target found is not the element itself,\r\n      // ignore it (to avoid using the root target in a nested same widget)\r\n      if (rootElement != null && rootElement.closest(tagName) != this) {\r\n        rootElement = null;\r\n      }\r\n\r\n      // Use found root target or element itself as renderRoot\r\n      root = rootElement ?? this;\r\n    } else {\r\n      root = super.createRenderRoot();\r\n    }\r\n\r\n    if (this.lightDOM && this.sharedStyles === true) {\r\n      console.warn(`[LitWidget \"${tagName}\"] Shared styles (sharedStyles = true) with lightDOM have no effect.`);\r\n    }\r\n\r\n    return root;\r\n  }\r\n\r\n  // #endregion Light DOM\r\n\r\n  // #region Lifecycle\r\n\r\n  connectedCallback() {\r\n    if (!this.#events) {\r\n      this.#prepareEvents();\r\n      this.#events = new EventsController(this, this.events);\r\n    }\r\n\r\n    super.connectedCallback();\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    super.disconnectedCallback();\r\n\r\n    if (typeof this._findCache !== 'undefined') {\r\n      this._findCache = {};\r\n    }\r\n  }\r\n\r\n  // #endregion Lifecycle\r\n\r\n}\r\n\r\n// #region Targets getters\r\n\r\nLitWidget.addInitializer((instance) => {\r\n  const klass = Object.getPrototypeOf(instance).constructor;\r\n\r\n  if (typeof klass.targets !== 'undefined') {\r\n    for (const [target, options] of Object.entries(klass.targets)) {\r\n      // Add target getter\r\n      Object.defineProperty(instance, options.property ?? target, {\r\n        configurable: true,\r\n        get() {\r\n          if (typeof this._findCache === 'undefined') {\r\n            this._findCache = {};\r\n          }\r\n\r\n          const cache = options.cache ?? true;\r\n\r\n          if (cache && this._findCache[target]) {\r\n            return this._findCache[target];\r\n          } else {\r\n            let targetElement = this._findCache[target] ??= this.findTarget(this.tagName, target, options.selector);\r\n            if (targetElement == null) {\r\n              console.error(`[LitWidget \"${klass.name}\"] Target \"${target}\" not found.`);\r\n            } else {\r\n              const convertTemplate = (options.template === true) || ((targetElement.tagName.toLowerCase() == 'template') && (options.template !== false));\r\n              if (convertTemplate) {\r\n                targetElement = templateContent(targetElement);\r\n              }\r\n              this._findCache[target] = targetElement;\r\n            }\r\n            return targetElement;\r\n          }\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  if (typeof klass.targetsAll !== 'undefined') {\r\n    for (const [target, options] of Object.entries(klass.targetsAll)) {\r\n      // Add target getter\r\n      Object.defineProperty(instance, options.property ?? target, {\r\n        configurable: true,\r\n        get() {\r\n          if (typeof this._findAllCache === 'undefined') {\r\n            this._findAllCache = {};\r\n          }\r\n\r\n          const cache = options.cache ?? true;\r\n\r\n          if (cache && this._findAllCache[target]) {\r\n            return this._findAllCache[target];\r\n          } else {\r\n            const targetElements = this._findAllCache[target] ??= this.findTargets(this.tagName, target, options.selector);\r\n            return targetElements;\r\n          }\r\n\r\n          // return this._findAllCache[target] ??= this.findTargets(this.tagName, target, options.selector);\r\n        }\r\n      });\r\n    }\r\n  }\r\n});\r\n\r\n// #endregion Targets getters\r\n","import { LitWidget } from './lit-widget';\r\n\r\n/**\r\n * Decorator to bind a property to a child HTML element\r\n *\r\n * ```js\r\n * class SampleWidget extends LitWidget {\r\n *\r\n *   @target button;\r\n *\r\n * }\r\n * ```\r\n *\r\n * By default, it binds to a child element with the `data-target` attribute equal to\r\n * the component's tag name and the name of the property connected by a dot,\r\n * like this - `tag-name.property-name`.\r\n *\r\n * The element is first looked up in renderRoot and then in the component tag itself.\r\n *\r\n * If a CSS selector is specified, the element with the matching selector\r\n * is searched for only among the child elements of the component tag.\r\n *\r\n * If the element being bound is the `<template>` tag, then by default\r\n * automatic conversion takes place using the Lit's directive `templateContent`.\r\n * To disable this behavior - you must specify `template: false`.\r\n *\r\n * @param {{name: string, selector: string, cache: Boolean, template: Boolean}} options - Optional parameters for binding.\r\n * @param {string} options.name - Target name to find the element to which the property will be bound.\r\n * @param {string} options.selector - CSS selector to find the element to which the property will be bound.\r\n * @param {Boolean} options.cache - Should the bind operation be cached or search for an element each time it is accessed?\r\n * @param {Boolean} options.template - Controls how the `<template>` tag is converted when bound.\r\n */\r\nexport function target({ name, selector, cache, template } = {}, propertyName = null) {\r\n  const wrapper = function(instance, property) {\r\n    const klass = instance.constructor;\r\n    if (!(instance instanceof LitWidget)) {\r\n      throw new Error(`[LitWidget] The class \"${klass.name}\" is not a descendant of LitWidget.`);\r\n    }\r\n\r\n    if (typeof klass.targets === 'undefined') {\r\n      klass.targets = {};\r\n    }\r\n    klass.targets[name ?? property] = {property, selector, cache, template};\r\n  };\r\n\r\n  if (propertyName == null) {\r\n    return wrapper;\r\n  } else {\r\n    const instance = arguments[0];\r\n    wrapper(instance, propertyName);\r\n  }\r\n}\r\n\r\n/**\r\n * Decorator to bind a property to an array of HTML child elements\r\n *\r\n * ```js\r\n * class SampleWidget extends LitWidget {\r\n *\r\n *   @targets emailEntries;\r\n *\r\n * }\r\n * ```\r\n *\r\n * By default, it binds to an array of child elements with a `data-targets`\r\n * attribute equal to the component's tag name and the name of the property\r\n * connected by a dot, like this - `tag-name.property-name`.\r\n *\r\n * Elements are looked up in renderRoot and in the component tag itself.\r\n *\r\n * If a CSS selector is specified, all elements with the matching selector\r\n * are searched only among the child elements of the component tag.\r\n *\r\n * @param {{name: string, selector: string, cache: Boolean}} options - Optional parameters for binding.\r\n * @param {string} options.name - Target name to find the elements to which the property will be bound.\r\n * @param {string} options.selector - CSS selector to find the elements to which the property will be bound.\r\n * @param {Boolean} options.cache - Should the bind operation be cached or search for an element each time it is accessed?\r\n */\r\nexport function targets({ name, selector, cache } = {}, propertyName = null) {\r\n  const wrapper = function(instance, property) {\r\n    const klass = instance.constructor;\r\n    if (!(instance instanceof LitWidget)) {\r\n      throw new Error(`[LitWidget] The class \"${klass.name}\" is not a descendant of LitWidget.`);\r\n    }\r\n\r\n    if (typeof klass.targetsAll === 'undefined') {\r\n      klass.targetsAll = {};\r\n    }\r\n    klass.targetsAll[name ?? property] = {property, selector, cache};\r\n  };\r\n\r\n  if (propertyName == null) {\r\n    return wrapper;\r\n  } else {\r\n    const instance = arguments[0];\r\n    wrapper(instance, propertyName);\r\n  }\r\n}\r\n\r\n/**\r\n * Decorator to attach a method as an HTML child element event handler\r\n *\r\n * ```js\r\n * class SampleWidget extends LitWidget {\r\n *\r\n *   @onEvent('button', 'click')\r\n *   greet(event) {\r\n *     ...\r\n *   }\r\n *\r\n * }\r\n * ```\r\n *\r\n * @param {(string|Window|Document|HTMLElement)} target - The name of the target to find the HTML element.\r\n *     You can pass an existing HTML element or window to attach an event handler to document.body or window for example.\r\n * @param {string|{eventName: string, isMatch: function}} event - The name of the DOM event to which the handler is attached.\r\n * @param {{selector: string, debounce: (Number|string), throttle: (Number|string), wrapper: function(function, this)}} options - Optional parameters for attaching an event.\r\n * @param {string} options.selector - This parameter allows you to filter the triggering of delegated events by CSS selector.\r\n * @param {string|number} options.debounce - Delay to debounce the execution of the event handler,\r\n *     you can specify the value in milliseconds as a number or in string format\r\n *     with the suffix `'<delay>ms'`, supported suffixes: ms - milliseconds, s - seconds, m - minutes.\r\n *     This can be handy for events such as key presses or \"input\" in input fields.\r\n * @param {string|number} options.throttle - Delay to throttle the execution of the event handler,\r\n *     you can specify the value in milliseconds as a number or in string format\r\n *     with the suffix `'<delay>ms'`, supported suffixes: ms - milliseconds, s - seconds, m - minutes.\r\n *     This can be handy for \"resize\" or \"scroll\" events.\r\n * @param {function} options.wrapper - Wrapper function to apply additional decorators to the event handler;\r\n *     can be useful for example to apply a debounce decorator with a delay set at runtime:\r\n *     `onEvent(..., wrapper: (fn, self) => debounce(fn, self.delay) )`.\r\n *     The first parameter in the wrapper is the event handler method,\r\n *     the second is a reference to the class instance.\r\n */\r\nexport function onEvent(target, event, { selector, debounce, throttle, wrapper } = {}) {\r\n  return function(instance, property) {\r\n    const klass = instance.constructor;\r\n    if (!(instance instanceof LitWidget)) {\r\n      throw new Error(`[LitWidget] The class \"${klass.name}\" is not a descendant of LitWidget.`);\r\n    }\r\n\r\n    if (typeof instance._events === 'undefined') {\r\n      instance._events = [];\r\n    }\r\n\r\n    instance._events.push({\r\n      target,\r\n      handler: instance[property],\r\n      event,\r\n      selector,\r\n      debounce,\r\n      throttle,\r\n      wrapper,\r\n    });\r\n  };\r\n}\r\n"],"names":["LitWidgetBase","LitElement","targetAttribute","targetsAttribute","createTargetPath","tagName","targetName","tag","toLowerCase","createTargetSelector","createTargetsSelector","targetMatches","el","selector","matches","targetsMatches","findTarget","converter","convert","value","querySelectorAll","closest","targetSelector","shadowRoot","findTargets","targets","push","targetsSelector","throttle","fn","delay","throttlePause","args","setTimeout","apply","duration","debounce","timeoutId","debouncer","clear","clearTimeout","Error","parseFloat","isNaN","endsWith","_class_private_field_loose_key","Symbol","iterator","ListenersMap","has","key","_class_private_field_loose_base","map","get","normalizeKey","set","listeners","Map","normalizedKey","delete","listener","constructor","JSON","stringify","EventHandler","addListener","addEventListener","eventName","handler","removeListener","removeEventListener","EventsController","prepareEvents","events","targetedEvents","event","target","HTMLElement","Document","Window","type","element","hostConnected","bindElementsEvents","bindTargetElements","host","listen","hostDisconnected","observer","disconnect","createHandler","wrapper","call","prevHandler","e","preset","isMatch","eventHandler","eventInfo","bindEvents","oldAttrValue","isOldMatch","id","isShadowNode","getRootNode","root","Element","hasAttribute","els","MutationObserver","mutations","mutation","oldValue","addedNodes","length","node","observe","childList","subtree","attributeFilter","attributeOldValue","addController","DocumentStylesObserver","observing","document","head","takeRecords","add","size","notifyListeners","operation","Set","removedNodes","getAttribute","SharedStylesController","initialized","renderRoot","ownerDocument","style","addStyle","startObserving","styleRoot","createElement","insertBefore","firstChild","styleClone","cloneNode","appendChild","styles","removeStyle","remove","stopObserving","stylesUpdated","updated","sharedStyles","WeakMap","o","LitWidget","widget","name","proto","options","define","customElements","static","Object","getPrototypeOf","render","html","defaultValues","_defaultValues","parentDefaultValues","lightDOM","createRenderRoot","rootElement","querySelector","console","warn","connectedCallback","disconnectedCallback","_findCache","sharedStylesController","_events","eventsDefs","index","defineProperty","configurable","addInitializer","instance","klass","entries","property","cache","targetElement","error","convertTemplate","template","templateContent","targetsAll","_findAllCache","targetElements","propertyName","arguments","onEvent"],"mappings":"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"}