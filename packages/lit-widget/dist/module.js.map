{"version":3,"file":"module.js","sources":["../src/debounce.js","../src/lit-widget.js","../src/decorators.js"],"sourcesContent":["\r\nexport function throttle(fn, duration) {\r\n  let throttlePause;\r\n\r\n  function throttler(...args) {\r\n    if (throttlePause) return;\r\n    throttlePause = true;\r\n\r\n    setTimeout(() => {\r\n      fn.apply(this, args);\r\n      throttlePause = false;\r\n    }, duration);\r\n  }\r\n\r\n  return throttler;\r\n}\r\n\r\nexport function debounce(fn, duration) {\r\n  let timeoutId;\r\n\r\n  function debouncer(...args) {\r\n    debouncer.clear();\r\n\r\n    timeoutId = setTimeout(() => {\r\n      timeoutId = null;\r\n\r\n      fn.apply(this, args);\r\n    }, duration);\r\n  }\r\n\r\n  debouncer.clear = function() {\r\n    if (timeoutId) {\r\n      clearTimeout(timeoutId);\r\n      timeoutId = null;\r\n    }\r\n  }\r\n\r\n  return debouncer;\r\n}\r\n\r\nexport function duration(value) {\r\n  if (typeof value === 'number') {\r\n    return value;\r\n  }\r\n  if (typeof value !== 'string') {\r\n    throw new Error(`Invalid duration \"${value}\".`);\r\n  }\r\n\r\n  const duration = parseFloat(value);\r\n  if (isNaN(duration)) {\r\n    throw new Error(`Invalid duration value \"${value}\".`);\r\n  }\r\n\r\n  if (value.endsWith('ms')) {\r\n    return duration;\r\n  }\r\n  if (value.endsWith('s')) {\r\n    return duration * 1000;\r\n  }\r\n  if (value.endsWith('m')) {\r\n    return duration * 1000 * 60;\r\n  }\r\n}\r\n","import { LitElement, html } from 'lit';\r\nimport { templateContent } from 'lit/directives/template-content.js';\r\nimport { throttle, debounce, duration } from './debounce';\r\n\r\n/**\r\n * Declarative binding to child elements for [LitElement](https://lit.dev/)\r\n * like [Github/Catalyst](https://catalyst.rocks/) and\r\n * [Stimulus.js](https://stimulus.hotwired.dev/).\r\n *\r\n * To define a widget, subclass LitWidget, specify targets using\r\n * the @target/@targets decorators or the targets/targetsAll static property,\r\n * and add event handlers using the @onEvent decorator or\r\n * the static events property.\r\n *\r\n * LitWidget unlike LitElement implements the **`render()`** method,\r\n * which renders all child elements of the widget through `<slot>`.\r\n * To change this behavior, simply override the `render` method and\r\n * implement your own rendering.\r\n *\r\n * LitWidget makes all page styles (both `<style>` and `<link>` tags) available\r\n * in **shadowRoot** by default (except styles with the `[data-shared=\"false\"]` attribute),\r\n * this behavior can be disabled by setting the `sharedStyles` static property to `false`.\r\n */\r\nexport class LitWidget extends LitElement {\r\n\r\n  static widget(name) {\r\n    return function(proto, options) {\r\n      LitWidget.define(name, proto, options);\r\n    }\r\n  }\r\n\r\n  static define(name, constructor, options) {\r\n    customElements.define('w-' + name, constructor, options);\r\n  }\r\n\r\n  render() {\r\n    return html`<slot></slot>`;\r\n  }\r\n\r\n  /**\r\n   * Specifies whether to import page styles into shadowRoot.\r\n   */\r\n  static sharedStyles = true\r\n\r\n  createRenderRoot() {\r\n    // Find handle [data-root]\r\n    let shadowRoot = true;\r\n    let root;\r\n    const tagName = this.tagName.toLowerCase();\r\n    const rootElement = this.querySelector(`[data-root=\"${tagName}\"]`);\r\n    if (!!rootElement && rootElement.closest(tagName) == this) {\r\n      root = rootElement;\r\n      shadowRoot = false;\r\n    } else {\r\n      root = super.createRenderRoot();\r\n    }\r\n\r\n    const sharedStyles = Object.getPrototypeOf(this).constructor.sharedStyles;\r\n\r\n    if (shadowRoot && sharedStyles) {\r\n      // Import styles\r\n      for (const style of document.head.querySelectorAll('style')) {\r\n        if (style.getAttribute('data-shared') == 'false') continue;\r\n        const styleClone = style.cloneNode(true);\r\n        root.insertBefore(styleClone, root.firstChild);\r\n      }\r\n\r\n      // Import link[stylesheet]\r\n      for (const style of document.head.querySelectorAll('link[rel=\"stylesheet\"]')) {\r\n        if (style.getAttribute('data-shared') == 'false') continue;\r\n        const styleClone = style.cloneNode(true);\r\n        root.insertBefore(styleClone, root.firstChild);\r\n      }\r\n    }\r\n\r\n    return root;\r\n  }\r\n\r\n  connectedCallback() {\r\n    super.connectedCallback();\r\n\r\n    setTimeout(() => this._attachEvents());\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    super.disconnectedCallback();\r\n\r\n    setTimeout(() => this._detachEvents());\r\n  }\r\n\r\n  get _events() {\r\n    const klass = Object.getPrototypeOf(this).constructor;\r\n    return klass.events || [];\r\n  }\r\n\r\n  _attachEvents() {\r\n    for (const event of this._events) {\r\n      if (event.debounce && event.throttle) {\r\n        throw new Error(`[LitWidget \"${$this.tagName.toLowerCase()}\"] For the event \"${event.event}\", debounce and throttle are specified, you can specify only one thing.`);\r\n      }\r\n\r\n      const target = this.findTarget(this.tagName, event.target);\r\n      if (target) {\r\n        let handler = event.handler;\r\n        if (typeof handler === 'string') handler = this[handler];\r\n\r\n        event._handler = (...args) => handler.apply(this, args);\r\n\r\n        if (event.debounce) {\r\n          event._handler = debounce(event._handler, duration(event.debounce));\r\n        } else if (event.throttle) {\r\n          event._handler = throttle(event._handler, duration(event.throttle));\r\n        }\r\n\r\n        if (event['wrapper'] != null && typeof event['wrapper'] !== 'undefined') {\r\n          event._handler = event.wrapper.call(this, event._handler, this);\r\n        }\r\n\r\n        target.addEventListener(event.event, event._handler);\r\n      } else {\r\n        throw new Error(`[LitWidget \"${this.tagName.toLowerCase()}\"] Event target \"${event.target}\" not found.`);\r\n      }\r\n    }\r\n  }\r\n\r\n  _detachEvents() {\r\n    for (const event of this._events) {\r\n      if (!!event._handler) {\r\n        target.addEventListener(event.event, event._handler);\r\n      }\r\n    }\r\n  }\r\n\r\n  findTarget(tagName, targetName, selector = null, converter = null) {\r\n    let convert = (value) => !!converter ? converter(value) : value;\r\n    const tag = tagName.toLowerCase();\r\n\r\n    if (!!selector) {\r\n      for (const el of this.querySelectorAll(selector)) {\r\n        if (el.closest(tag) === this) {\r\n          return convert(el);\r\n        }\r\n      }\r\n    }\r\n\r\n    if (this.renderRoot) {\r\n      for (const el of this.renderRoot.querySelectorAll(`[data-target~=\"${tag}.${targetName}\"]`)) {\r\n        if (!el.closest(tag)) return convert(el);\r\n      }\r\n    }\r\n\r\n    for (const el of this.querySelectorAll(`[data-target~=\"${tag}.${targetName}\"]`)) {\r\n      if (el.closest(tag) === this) return convert(el);\r\n    }\r\n  }\r\n\r\n  findTargets(tagName, targetName, selector = null, converter = null) {\r\n    let convert = (value) => !!converter ? converter(value) : value;\r\n    const tag = tagName.toLowerCase();\r\n    const targets = [];\r\n\r\n    if (!!selector) {\r\n      for (const el of this.querySelectorAll(selector)) {\r\n        if (el.closest(tag) === this) {\r\n          targets.push(convert(el));\r\n        }\r\n      }\r\n    }\r\n\r\n    if (this.renderRoot) {\r\n      for (const el of this.renderRoot.querySelectorAll(`[data-targets~=\"${tag}.${targetName}\"]`)) {\r\n        if (!el.closest(tag)) {\r\n          targets.push(convert(el));\r\n        }\r\n      }\r\n    }\r\n\r\n    for (const el of this.querySelectorAll(`[data-targets~=\"${tag}.${targetName}\"]`)) {\r\n      if (el.closest(tag) === this) {\r\n        targets.push(convert(el));\r\n      }\r\n    }\r\n\r\n    return targets;\r\n  }\r\n\r\n}\r\n\r\nLitWidget.addInitializer((instance) => {\r\n  const klass = Object.getPrototypeOf(instance).constructor;\r\n\r\n  if (typeof klass.targets !== 'undefined') {\r\n    for (const [target, options] of Object.entries(klass.targets)) {\r\n      // Add target getter\r\n      Object.defineProperty(instance, target, {\r\n        configurable: true,\r\n        get() {\r\n          if (typeof this._findCache === 'undefined') {\r\n            this._findCache = {};\r\n          }\r\n\r\n          if (this._findCache[target]) {\r\n            return this._findCache[target];\r\n          } else {\r\n            const targetElement = this._findCache[target] ??= this.findTarget(this.tagName, target, options.selector, options.template ? (value) => templateContent(value) : null);\r\n            if (targetElement == null) {\r\n              console.error(`[LitWidget \"${klass.name}\"] Target \"${target}\" not found.`);\r\n            } else {\r\n              this._findCache[target] = targetElement;\r\n            }\r\n            return targetElement;\r\n          }\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  if (typeof klass.targetsAll !== 'undefined') {\r\n    for (const [target, options] of Object.entries(klass.targetsAll)) {\r\n      // Add target getter\r\n      Object.defineProperty(instance, target, {\r\n        configurable: true,\r\n        get() {\r\n          if (typeof this._findCache === 'undefined') {\r\n            this._findCache = {};\r\n          }\r\n          return this._findCache[target] ??= this.findTargets(this.tagName, target, options.selector, options.template ? (value) => templateContent(value) : null);\r\n        }\r\n      });\r\n    }\r\n  }\r\n});\r\n","\r\nimport { LitWidget } from './lit-widget';\r\n\r\nexport function target({ selector } = {}, name = null) {\r\n  const wrapper = function(instance, property) {\r\n    const klass = instance.constructor;\r\n    if (!(instance instanceof LitWidget)) {\r\n      throw new Error(`[LitWidget] The class \"${klass.name}\" is not a descendant of LitWidget.`);\r\n    }\r\n\r\n    if (typeof klass.targets === 'undefined') {\r\n      klass.targets = {};\r\n    }\r\n    klass.targets[property] = {selector};\r\n  };\r\n\r\n  if (name == null) {\r\n    return wrapper;\r\n  } else {\r\n    const instance = arguments[0];\r\n    wrapper(instance, name);\r\n  }\r\n}\r\n\r\nexport function targets({ selector } = {}, name = null) {\r\n  const wrapper = function(instance, property) {\r\n    const klass = instance.constructor;\r\n    if (!(instance instanceof LitWidget)) {\r\n      throw new Error(`[LitWidget] The class \"${klass.name}\" is not a descendant of LitWidget.`);\r\n    }\r\n\r\n    if (typeof klass.targetsAll === 'undefined') {\r\n      klass.targetsAll = {};\r\n    }\r\n    klass.targetsAll[property] = {selector};\r\n  };\r\n\r\n  if (name == null) {\r\n    return wrapper;\r\n  } else {\r\n    const instance = arguments[0];\r\n    wrapper(instance, name);\r\n  }\r\n}\r\n\r\nexport function onEvent(target, event, { debounce, throttle, wrapper } = {}) {\r\n  return function(instance, property) {\r\n    const klass = instance.constructor;\r\n    if (!(instance instanceof LitWidget)) {\r\n      throw new Error(`[LitWidget] The class \"${klass.name}\" is not a descendant of LitWidget.`);\r\n    }\r\n\r\n    if (typeof klass.events === 'undefined') {\r\n      klass.events = [];\r\n    }\r\n\r\n    klass.events.push({\r\n      target: target,\r\n      handler: instance[property],\r\n      event: event,\r\n      debounce: debounce || null,\r\n      throttle: throttle || null,\r\n      wrapper: wrapper || null,\r\n    });\r\n  };\r\n}\r\n"],"names":["throttle","fn","duration","throttlePause","args","setTimeout","apply","debounce","timeoutId","debouncer","clear","clearTimeout","value","Error","parseFloat","isNaN","endsWith","LitWidget","LitElement","widget","name","proto","options","define","constructor","customElements","render","html","createRenderRoot","root","shadowRoot","tagName","toLowerCase","rootElement","querySelector","closest","sharedStyles","Object","getPrototypeOf","style","document","head","querySelectorAll","getAttribute","styleClone","cloneNode","insertBefore","firstChild","connectedCallback","_attachEvents","disconnectedCallback","_detachEvents","_events","klass","events","event","$this","target","findTarget","handler","_handler","wrapper","call","addEventListener","targetName","selector","converter","convert","tag","el","renderRoot","findTargets","targets","push","addInitializer","instance","entries","defineProperty","configurable","get","_findCache","targetElement","template","templateContent","console","error","targetsAll","property","arguments","onEvent"],"mappings":";;;;;;;;;AACO,SAASA,QAAAA,CAASC,EAAE,EAAEC,QAAQ,EAAA;IACnC,IAAIC,aAAAA,CAAAA;IAYJ,OAVA,SAAmB,GAAGC,IAAI,EAAA;QACpBD,aACJA,KAAAA,aAAAA,GAAgB,CAAA,CAAA,EAEhBE,UAAW,CAAA,IAAA;AACTJ,YAAAA,EAAAA,CAAGK,KAAM,CAAA,IAAI,EAAEF,IAAAA,CAAAA,EACfD,gBAAgB,CAAA,CAAA,CAAA;SACfD,EAAAA,QAAAA,CAAAA,CAAAA,CAAAA;AACL,KAAA,CAAA;AAGF,CAAA;AAEO,SAASK,QAAAA,CAASN,EAAE,EAAEC,QAAQ,EAAA;IACnC,IAAIM,SAAAA,CAAAA;IAEJ,SAASC,SAAAA,CAAU,GAAGL,IAAI,EAAA;QACxBK,SAAUC,CAAAA,KAAAA,EAAAA,EAEVF,YAAYH,UAAW,CAAA,IAAA;AACrBG,YAAAA,SAAAA,GAAY,IAEZP,EAAAA,EAAAA,CAAGK,KAAM,CAAA,IAAI,EAAEF,IAAAA,CAAAA,CAAAA;SACdF,EAAAA,QAAAA,CAAAA,CAAAA;AACL,KAAA;AASA,IAAA,OAPAO,UAAUC,KAAQ,GAAA,WAAA;QACZF,SACFG,KAAAA,YAAAA,CAAaH,YACbA,SAAY,GAAA,IAAA,CAAA,CAAA;KAITC,EAAAA,SAAAA,CAAAA;AACT,CAAA;AAEO,SAASP,SAASU,KAAK,EAAA;AAC5B,IAAA,IAAI,QAAiB,IAAjB,OAAOA,KAAAA,EACT,OAAOA,KAAAA,CAAAA;AAET,IAAA,IAAI,QAAiB,IAAjB,OAAOA,KAAAA,EACT,MAAUC,KAAM,CAAA,CAAC,kBAAkB,EAAED,KAAM,CAAA,EAAE,CAAC,CAAA,CAAA;AAGhD,IAAA,IAAMV,WAAWY,UAAWF,CAAAA,KAAAA,CAAAA,CAAAA;IAC5B,IAAIG,KAAAA,CAAMb,QACR,CAAA,EAAA,MAAM,KAAIW,CAAM,CAAC,wBAAwB,EAAED,KAAM,CAAA,EAAE,CAAC,CAAA,CAAA;AAGtD,IAAA,OAAIA,KAAMI,CAAAA,QAAAA,CAAS,IACVd,CAAAA,GAAAA,QAAAA,GAELU,KAAMI,CAAAA,QAAAA,CAAS,GACVd,CAAAA,GAAW,IAAXA,GAAAA,QAAAA,GAELU,KAAMI,CAAAA,QAAAA,CAAS,OACVd,KAAAA,GAAAA,QAAAA,GAAAA,KAAAA,CAAAA,CAAAA;AAEX;;AC1DA;;;;;;;;;;;;;;;;;;IAmBO,MAAMe,SAAkBC,SAAAA,UAAAA,CAAAA;IAE7B,OAAOC,MAAAA,CAAOC,IAAI,EAAE;QAClB,OAAO,SAASC,KAAK,EAAEC,OAAO,EAAA;YAC5BL,SAAUM,CAAAA,MAAAA,CAAOH,MAAMC,KAAOC,EAAAA,OAAAA,CAAAA,CAAAA;AAChC,SAAA,CAAA;AACF,KAAA;AAEA,IAAA,OAAOC,OAAOH,IAAI,EAAEI,WAAW,EAAEF,OAAO,EAAE;QACxCG,cAAeF,CAAAA,MAAAA,CAAO,IAAOH,GAAAA,IAAAA,EAAMI,WAAaF,EAAAA,OAAAA,CAAAA,CAAAA;AAClD,KAAA;IAEAI,MAAS,GAAA;QACP,OAAOC,IAAI,CAAC,aAAa,CAAC,CAAA;AAC5B,KAAA;IAOAC,gBAAmB,GAAA;;AAEjB,QAAA,IACIC,MADAC,UAAa,GAAA,CAAA,GAEXC,OAAU,GAAA,IAAI,CAACA,OAAQC,CAAAA,WAAAA,EAAAA,EACvBC,WAAc,GAAA,IAAI,CAACC,aAAc,CAAA,CAAC,YAAY,EAAEH,OAAAA,CAAQ,EAAE,CAAC,CAAA,CAAA;AAC3DE,QAAAA,WAAAA,IAAeA,WAAYE,CAAAA,OAAAA,CAAQJ,OAAY,CAAA,IAAA,IAAI,IACvDF,IAAAA,GAAOI,WACPH,EAAAA,UAAAA,GAAa,CAAA,CAAA,IAEbD,IAAO,GAAA,KAAK,CAACD,gBAAAA,EAAAA,CAAAA;AAGf,QAAA,IAAMQ,YAAeC,GAAAA,MAAAA,CAAOC,cAAe,CAAA,IAAI,EAAEd,WAAYY,CAAAA,YAAAA,CAAAA;AAE7D,QAAA,IAAIN,cAAcM,YAAc,EAAA;;AAE9B,YAAA,KAAK,IAAMG,KAAAA,IAASC,QAASC,CAAAA,IAAAA,CAAKC,iBAAiB,OAAU,CAAA,CAAA;AAC3D,gBAAA,IAAIH,OAAqC,IAArCA,KAAMI,CAAAA,YAAAA,CAAa,aAA2B,CAAA,EAAA,SAAA;gBAClD,IAAMC,UAAAA,GAAaL,KAAMM,CAAAA,SAAAA,CAAU,CAAA,CAAA,CAAA,CAAA;gBACnChB,IAAKiB,CAAAA,YAAAA,CAAaF,YAAYf,IAAKkB,CAAAA,UAAAA,CAAAA,CAAAA;AACrC,aAAA;;AAGA,YAAA,KAAK,IAAMR,KAAAA,IAASC,QAASC,CAAAA,IAAAA,CAAKC,iBAAiB,wBAA2B,CAAA,CAAA;AAC5E,gBAAA,IAAIH,OAAqC,IAArCA,KAAMI,CAAAA,YAAAA,CAAa,aAA2B,CAAA,EAAA,SAAA;gBAClD,IAAMC,UAAAA,GAAaL,KAAMM,CAAAA,SAAAA,CAAU,CAAA,CAAA,CAAA,CAAA;gBACnChB,IAAKiB,CAAAA,YAAAA,CAAaF,YAAYf,IAAKkB,CAAAA,UAAAA,CAAAA,CAAAA;AACrC,aAAA;AACF,SAAA;QAEA,OAAOlB,IAAAA,CAAAA;AACT,KAAA;IAEAmB,iBAAoB,GAAA;AAClB,QAAA,KAAK,CAACA,iBAAAA,EAAAA,EAEN3C,UAAW,CAAA,IAAM,IAAI,CAAC4C,aAAAA,EAAAA,CAAAA,CAAAA;AACxB,KAAA;IAEAC,oBAAuB,GAAA;AACrB,QAAA,KAAK,CAACA,oBAAAA,EAAAA,EAEN7C,UAAW,CAAA,IAAM,IAAI,CAAC8C,aAAAA,EAAAA,CAAAA,CAAAA;AACxB,KAAA;AAEA,IAAA,IAAIC,OAAU,GAAA;AACZ,QAAA,IAAMC,KAAQhB,GAAAA,MAAAA,CAAOC,cAAe,CAAA,IAAI,CAAEd,CAAAA,WAAAA,CAAAA;QAC1C,OAAO6B,KAAAA,CAAMC,UAAU,EAAE,CAAA;AAC3B,KAAA;IAEAL,aAAgB,GAAA;AACd,QAAA,KAAK,IAAMM,KAAAA,IAAS,IAAI,CAACH,OAAS,CAAA;AAChC,YAAA,IAAIG,MAAMhD,QAAYgD,IAAAA,KAAAA,CAAMvD,UAC1B,MAAUa,MAAM,CAAC,YAAY,EAAE2C,KAAAA,CAAMzB,QAAQC,WAAc,EAAA,CAAA,kBAAkB,EAAEuB,KAAMA,CAAAA,KAAAA,CAAM,uEAAuE,CAAC,CAAA,CAAA;AAGrK,YAAA,IAAME,UAAS,IAAI,CAACC,WAAW,IAAI,CAAC3B,SAASwB,KAAME,CAAAA,MAAAA,CAAAA,CAAAA;AACnD,YAAA,IAAIA,OAAQ,EAAA;AACV,gBAAA,IAAIE,UAAUJ,KAAMI,CAAAA,OAAAA,CAAAA;AACG,gBAAA,QAAA,IAAnB,OAAOA,OAAAA,KAAsBA,OAAAA,GAAU,IAAI,CAACA,OAAQ,CAAD,CAEvDJ,EAAAA,KAAAA,CAAMK,QAAW,GAAA,CAAC,GAAGxD,IAASuD,GAAAA,OAAAA,CAAQrD,KAAM,CAAA,IAAI,EAAEF,IAAAA,CAAAA,EAE9CmD,KAAMhD,CAAAA,QAAAA,GACRgD,MAAMK,QAAWrD,GAAAA,QAAAA,CAASgD,KAAMK,CAAAA,QAAAA,EAAU1D,QAASqD,CAAAA,KAAAA,CAAMhD,QAChDgD,CAAAA,CAAAA,GAAAA,KAAAA,CAAMvD,aACfuD,KAAAA,CAAMK,QAAW5D,GAAAA,QAAAA,CAASuD,KAAMK,CAAAA,QAAAA,EAAU1D,QAASqD,CAAAA,KAAAA,CAAMvD,QAAS,CAAA,CAAA,CAAA,EAG5C,IAApBuD,IAAAA,KAAAA,CAAM,OAAsB,IAA4B,KAAA,CAAA,KAArBA,MAAM,OAC3CA,KAAAA,KAAMK,CAAAA,QAAAA,GAAWL,KAAMM,CAAAA,OAAAA,CAAQC,IAAK,CAAA,IAAI,EAAEP,KAAMK,CAAAA,QAAAA,EAAU,IAAI,CAAA,CAGhEH,EAAAA,OAAAA,CAAOM,gBAAiBR,CAAAA,KAAAA,CAAMA,OAAOA,KAAMK,CAAAA,QAAAA,CAAAA,CAAAA;AAC7C,aAAA,MACE,MAAU/C,KAAM,CAAA,CAAC,YAAY,EAAE,IAAI,CAACkB,OAAAA,CAAQC,cAAc,iBAAiB,EAAEuB,KAAME,CAAAA,MAAAA,CAAO,YAAY,CAAC,CAAA,CAAA;AAE3G,SAAA;AACF,KAAA;IAEAN,aAAgB,GAAA;QACd,KAAK,IAAMI,KAAS,IAAA,IAAI,CAACH,OAAAA,CACjBG,KAAMK,CAAAA,QAAAA,IACVH,MAAOM,CAAAA,gBAAAA,CAAiBR,KAAMA,CAAAA,KAAAA,EAAOA,KAAMK,CAAAA,QAAAA,CAAAA,CAAAA;AAGjD,KAAA;IAEAF,UAAW3B,CAAAA,OAAO,EAAEiC,UAAU,EAAEC,WAAW,IAAI,EAAEC,SAAY,GAAA,IAAI,EAAE;QACjE,IAAIC,OAAAA,GAAU,CAACvD,KAAU,GAAEsD,YAAYA,SAAUtD,CAAAA,KAAAA,CAAAA,GAASA,KACpDwD,EAAAA,GAAAA,GAAMrC,OAAQC,CAAAA,WAAAA,EAAAA,CAAAA;AAEpB,QAAA,IAAMiC,QACJ,EAAA;AAAA,YAAA,KAAK,IAAMI,EAAAA,IAAM,IAAI,CAAC3B,gBAAiBuB,CAAAA,QAAAA,CAAAA,CACrC,IAAII,EAAAA,CAAGlC,OAAQiC,CAAAA,GAAAA,CAAAA,KAAS,IAAI,EAC1B,OAAOD,OAAQE,CAAAA,EAAAA,CAAAA,CAAAA;AAEnB,SAAA;QAGF,IAAI,IAAI,CAACC,UACP,EAAA;YAAA,KAAK,IAAMD,MAAM,IAAI,CAACC,WAAW5B,gBAAiB,CAAA,CAAC,eAAe,EAAE0B,GAAI,CAAA,CAAC,EAAEJ,UAAW,CAAA,EAAE,CAAC,CACvF,CAAA,IAAI,CAACK,EAAGlC,CAAAA,OAAAA,CAAQiC,GAAM,CAAA,EAAA,OAAOD,OAAQE,CAAAA,EAAAA,CAAAA,CAAAA;AACvC,SAAA;QAGF,KAAK,IAAMA,MAAM,IAAI,CAAC3B,iBAAiB,CAAC,eAAe,EAAE0B,GAAAA,CAAI,CAAC,EAAEJ,WAAW,EAAE,CAAC,EAC5E,IAAIK,EAAAA,CAAGlC,QAAQiC,GAAS,CAAA,KAAA,IAAI,EAAE,OAAOD,OAAQE,CAAAA,EAAAA,CAAAA,CAAAA;AAEjD,KAAA;IAEAE,WAAYxC,CAAAA,OAAO,EAAEiC,UAAU,EAAEC,WAAW,IAAI,EAAEC,SAAY,GAAA,IAAI,EAAE;AAClE,QAAA,IAAIC,OAAU,GAAA,CAACvD,KAAU,GAAEsD,SAAYA,GAAAA,SAAAA,CAAUtD,KAASA,CAAAA,GAAAA,KAAAA,EACpDwD,GAAMrC,GAAAA,OAAAA,CAAQC,WACdwC,EAAAA,EAAAA,OAAAA,GAAU,EAAE,CAAA;AAElB,QAAA,IAAMP,QACJ,EAAA,KAAK,IAAMI,EAAAA,IAAM,IAAI,CAAC3B,gBAAAA,CAAiBuB,QACjCI,CAAAA,CAAAA,EAAAA,CAAGlC,QAAQiC,GAAS,CAAA,KAAA,IAAI,IAC1BI,OAAAA,CAAQC,KAAKN,OAAQE,CAAAA,EAAAA,CAAAA,CAAAA,CAAAA;QAK3B,IAAI,IAAI,CAACC,UAAAA,EACP,KAAK,IAAMD,MAAM,IAAI,CAACC,UAAW5B,CAAAA,gBAAAA,CAAiB,CAAC,gBAAgB,EAAE0B,GAAI,CAAA,CAAC,EAAEJ,UAAAA,CAAW,EAAE,CAAC,CACnFK,CAAAA,EAAAA,CAAGlC,OAAQiC,CAAAA,GAAAA,CAAAA,IACdI,OAAQC,CAAAA,IAAAA,CAAKN,OAAQE,CAAAA,EAAAA,CAAAA,CAAAA,CAAAA;QAK3B,KAAK,IAAMA,MAAM,IAAI,CAAC3B,iBAAiB,CAAC,gBAAgB,EAAE0B,GAAAA,CAAI,CAAC,EAAEJ,WAAW,EAAE,CAAC,EACzEK,EAAGlC,CAAAA,OAAAA,CAAQiC,SAAS,IAAI,IAC1BI,OAAQC,CAAAA,IAAAA,CAAKN,OAAQE,CAAAA,EAAAA,CAAAA,CAAAA,CAAAA;QAIzB,OAAOG,OAAAA,CAAAA;AACT,KAAA;AAEF,CAAA;AAnJE;;AAEC,MAlBUvD,UAmBJmB,YAAe,GAAA,CAAA,CAkJxBnB,EAAAA,SAAAA,CAAUyD,eAAe,CAACC,QAAAA,GAAAA;IACxB,IAAMtB,KAAAA,GAAQhB,MAAOC,CAAAA,cAAAA,CAAeqC,QAAUnD,CAAAA,CAAAA,WAAAA,CAAAA;AAE9C,IAAA,IAAI,KAAyB,CAAlB6B,KAAAA,KAAAA,CAAMmB,SACf,KAAK,IAAM,CAACf,OAAAA,EAAQnC,QAAQ,IAAIe,MAAAA,CAAOuC,OAAQvB,CAAAA,KAAAA,CAAMmB;IAEnDnC,MAAOwC,CAAAA,cAAAA,CAAeF,UAAUlB,OAAQ,EAAA;AACtCqB,QAAAA,YAAAA,EAAc,CAAA,CAAA;AACdC,QAAAA,GAAAA,CAAAA,GAAAA;YAKE,IAJ+B,KAAA,MAApB,IAAI,CAACC,eACd,IAAI,CAACA,UAAAA,GAAa,EAAC,GAGjB,IAAI,CAACA,UAAU,CAACvB,OAAO,CAAA,EACzB,OAAO,IAAI,CAACuB,UAAU,CAACvB,OAAO,CAAA,CAAA;AACzB,YAAA;AACiB,gBAAA,IAAA,gBAAA,EAAA,CAAA,CAAA;gBAAtB,IAAMwB,aAAAA,GAAgB,IAAA,KAAA,CAAA,GAAA,CAAA,gBAAA,GAAA,IAAI,CAACD,UAAU,EAACvB,OAAO,CAAA,CAAA,GAAA,CAAA,GAAvB,gBAAe,CAACA,OAAO,CAAA,GAAK,IAAI,CAACC,UAAW,CAAA,IAAI,CAAC3B,OAAAA,EAAS0B,OAAQnC,EAAAA,OAAAA,CAAQ2C,QAAU3C,EAAAA,OAAAA,CAAQ4D,QAAW,GAAA,CAACtE,KAAUuE,GAAAA,eAAAA,CAAgBvE,KAAS,CAAA,GAAA,IAAA,CAAA,CAAA;gBAMjK,OALqB,QAAjBqE,aACFG,GAAAA,OAAAA,CAAQC,MAAM,CAAC,YAAY,EAAEhC,KAAAA,CAAMjC,IAAK,CAAA,WAAW,EAAEqC,OAAO,CAAA,YAAY,CAAC,CAEzE,GAAA,IAAI,CAACuB,UAAU,CAACvB,OAAO,CAAA,GAAGwB,aAErBA,EAAAA,aAAAA,CAAAA;AACT,aAAA;AACF,SAAA;AACF,KAAA,CAAA,CAAA;AAIJ,IAAA,IAAI,KAA4B,CAArB5B,KAAAA,KAAAA,CAAMiC,YACf,KAAK,IAAM,CAAC7B,OAAAA,EAAQnC,QAAQ,IAAIe,MAAAA,CAAOuC,OAAQvB,CAAAA,KAAAA,CAAMiC;IAEnDjD,MAAOwC,CAAAA,cAAAA,CAAeF,UAAUlB,OAAQ,EAAA;AACtCqB,QAAAA,YAAAA,EAAc,CAAA,CAAA;AACdC,QAAAA,GAAAA,CAAAA,GAAAA;AAIS,YAAA,IAAA,gBAAA,EAAA,CAAA,CAAA;AAAP,YAAA,OAH+B,KAAA,CAApB,KAAA,IAAI,CAACC,UAAAA,KACd,IAAI,CAACA,UAAa,GAAA,EAAC,CAEd,EAAA,IAAA,KAAA,CAAA,GAAA,CAAA,mBAAA,IAAI,CAACA,YAAWvB,OAAAA,CAAO,CAAvB,GAAA,CAAA,GAAA,gBAAe,CAACA,OAAO,CAAA,GAAK,IAAI,CAACc,YAAY,IAAI,CAACxC,OAAS0B,EAAAA,OAAAA,EAAQnC,QAAQ2C,QAAU3C,EAAAA,OAAAA,CAAQ4D,WAAW,CAACtE,KAAAA,GAAUuE,gBAAgBvE,KAAS,CAAA,GAAA,IAAA,CAAA,CAAA;AACrJ,SAAA;AACF,KAAA,CAAA,CAAA;AAGN,CAAA,CAAA;;ACpOO,SAAS6C,QAAO,CAAA,EAAEQ,QAAQ,GAAE,GAAG,EAAE,EAAE7C,IAAAA,GAAO,IAAI,EAAA;AACnD,IAAA,IAAMyC,OAAU,GAAA,SAASc,QAAQ,EAAEY,QAAQ,EAAA;AACzC,QAAA,IAAMlC,QAAQsB,QAASnD,CAAAA,WAAAA,CAAAA;AACvB,QAAA,IAAI,EAAEmD,QAAoB1D,YAAAA,SAAQ,GAChC,MAAUJ,KAAM,CAAA,CAAC,uBAAuB,EAAEwC,KAAMjC,CAAAA,IAAAA,CAAK,mCAAmC,CAAC,CAAA,CAAA;AAG9D,QAAA,KAAA,CAAlBiC,KAAAA,KAAAA,CAAMmB,OACfnB,KAAAA,KAAMmB,CAAAA,OAAAA,GAAU,EAAC,CAEnBnB,EAAAA,KAAAA,CAAMmB,OAAO,CAACe,SAAS,GAAG;AAACtB,YAAAA,QAAAA;AAAQ,SAAA,CAAA;AACrC,KAAA,CAAA;IAEA,IAAY,IAAR7C,IAAAA,IAAAA,EACF,OAAOyC,OAAAA,CAAAA;AACF,IAAA;QACL,IAAMc,QAAAA,GAAWa,SAAS,CAAC,CAAE,CAAA,CAAA;AAC7B3B,QAAAA,OAAAA,CAAQc,QAAUvD,EAAAA,IAAAA,CAAAA,CAAAA;AACpB,KAAA;AACF,CAAA;AAEO,SAASoD,OAAQ,CAAA,EAAEP,QAAQ,GAAE,GAAG,EAAE,EAAE7C,IAAAA,GAAO,IAAI,EAAA;AACpD,IAAA,IAAMyC,OAAU,GAAA,SAASc,QAAQ,EAAEY,QAAQ,EAAA;AACzC,QAAA,IAAMlC,QAAQsB,QAASnD,CAAAA,WAAAA,CAAAA;AACvB,QAAA,IAAI,EAAEmD,QAAoB1D,YAAAA,SAAQ,GAChC,MAAUJ,KAAM,CAAA,CAAC,uBAAuB,EAAEwC,KAAMjC,CAAAA,IAAAA,CAAK,mCAAmC,CAAC,CAAA,CAAA;AAG3D,QAAA,KAAA,CAArBiC,KAAAA,KAAAA,CAAMiC,UACfjC,KAAAA,KAAMiC,CAAAA,UAAAA,GAAa,EAAC,CAEtBjC,EAAAA,KAAAA,CAAMiC,UAAU,CAACC,SAAS,GAAG;AAACtB,YAAAA,QAAAA;AAAQ,SAAA,CAAA;AACxC,KAAA,CAAA;IAEA,IAAY,IAAR7C,IAAAA,IAAAA,EACF,OAAOyC,OAAAA,CAAAA;AACF,IAAA;QACL,IAAMc,QAAAA,GAAWa,SAAS,CAAC,CAAE,CAAA,CAAA;AAC7B3B,QAAAA,OAAAA,CAAQc,QAAUvD,EAAAA,IAAAA,CAAAA,CAAAA;AACpB,KAAA;AACF,CAAA;AAEO,SAASqE,OAAAA,CAAQhC,MAAM,EAAEF,KAAK,EAAE,EAAEhD,QAAQ,GAAEP,WAAU6D,OAAAA,GAAS,GAAG,EAAE,EAAA;IACzE,OAAO,SAASc,QAAQ,EAAEY,QAAQ,EAAA;AAChC,QAAA,IAAMlC,QAAQsB,QAASnD,CAAAA,WAAAA,CAAAA;AACvB,QAAA,IAAI,EAAEmD,QAAoB1D,YAAAA,SAAQ,GAChC,MAAUJ,KAAM,CAAA,CAAC,uBAAuB,EAAEwC,KAAMjC,CAAAA,IAAAA,CAAK,mCAAmC,CAAC,CAAA,CAAA;QAG/D,KAAA,CAAA,KAAjBiC,KAAMC,CAAAA,MAAAA,KACfD,KAAAA,CAAMC,MAAS,GAAA,EAAE,CAAD,EAGlBD,KAAMC,CAAAA,MAAAA,CAAOmB,IAAK,CAAA;YAChBhB,MAAQA,EAAAA,MAAAA;YACRE,OAASgB,EAAAA,QAAQ,CAACY,QAAS,CAAA;YAC3BhC,KAAOA,EAAAA,KAAAA;AACPhD,YAAAA,QAAAA,EAAUA,QAAY,IAAA,IAAA;AACtBP,YAAAA,QAAAA,EAAUA,QAAY,IAAA,IAAA;AACtB6D,YAAAA,OAAAA,EAASA,OAAW,IAAA,IAAA;AACtB,SAAA,CAAA,CAAA;AACF,KAAA,CAAA;AACF;;;;"}