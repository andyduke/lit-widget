{"version":3,"file":"index.js","sources":["../src/lit-widget-base.js","../src/tools/debounce.js","../src/tools/listeners-map.js","../src/controllers/events-controller.js","../src/controllers/shared-styles-controller.js","../src/lit-widget.js","../src/decorators.js"],"sourcesContent":["import { LitElement } from 'lit';\r\n\r\nexport class LitWidgetBase extends LitElement {\r\n\r\n  get targetAttribute() {\r\n    return 'data-target';\r\n  }\r\n\r\n  get targetsAttribute() {\r\n    return 'data-targets';\r\n  }\r\n\r\n  createTargetPath(tagName, targetName) {\r\n    const tag = tagName.toLowerCase();\r\n    return `${tag}.${targetName}`;\r\n  }\r\n\r\n  createTargetSelector(tagName, targetName) {\r\n    const tag = tagName.toLowerCase();\r\n    return `[${this.targetAttribute}~=\"${tag}.${targetName}\"]`;\r\n  }\r\n\r\n  createTargetsSelector(tagName, targetName) {\r\n    const tag = tagName.toLowerCase();\r\n    return `[${this.targetsAttribute}~=\"${tag}.${targetName}\"]`;\r\n  }\r\n\r\n  targetMatches(el, tagName, targetName) {\r\n    const selector = this.createTargetSelector(tagName, targetName);\r\n    return el.matches(selector);\r\n  }\r\n\r\n  targetsMatches(el, tagName, targetName) {\r\n    const selector = this.createTargetsSelector(tagName, targetName);\r\n    return el.matches(selector);\r\n  }\r\n\r\n  /**\r\n   * findTarget will run `querySelectorAll` against the given widget element, plus\r\n   * its shadowRoot, returning any the first child that:\r\n   *\r\n   *  - Matches the selector of `[data-target~=\"tag.name\"]` where tag is the\r\n   *    tagName of the HTMLElement, and `name` is the given `targetName` argument.\r\n   *\r\n   *  - Closest ascendant of the element, that matches the tagname of the\r\n   *    widget, is the specific instance of the widget itself - in other\r\n   *    words it is not nested in other widgets of the same type.\r\n   *\r\n   * @param {string} tagName - HTML element tag name\r\n   * @param {string} targetName - Widget property name\r\n   * @param {string} [selector] - Selector to find element instead of using [data-target]\r\n   * @param {Function} [converter] - The result converter can be used to convert the tag, for example using templateContent\r\n   * @returns {(HTMLElement|any|null)} The HTML element found, or null if no matching element was found\r\n   */\r\n  findTarget(tagName, targetName, selector = null, converter = null) {\r\n    let convert = (value) => !!converter ? converter(value) : value;\r\n    const tag = tagName.toLowerCase();\r\n\r\n    if (!!selector) {\r\n      for (const el of this.querySelectorAll(selector)) {\r\n        if (el.closest(tag) === this) {\r\n          return convert(el);\r\n        }\r\n      }\r\n    }\r\n\r\n    const targetSelector = this.createTargetSelector(tag, targetName);\r\n\r\n    if (this.shadowRoot) {\r\n      for (const el of this.shadowRoot.querySelectorAll(targetSelector)) {\r\n        if (!el.closest(tag)) return convert(el);\r\n      }\r\n    }\r\n\r\n    for (const el of this.querySelectorAll(targetSelector)) {\r\n      if (el.closest(tag) === this) return convert(el);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * findTargets will run `querySelectorAll` against the given widget element, plus\r\n   * its shadowRoot, returning all matching child elements that are:\r\n   *\r\n   *  - Matches the selector of `[data-targets~=\"tag.name\"]` where tag is the\r\n   *    tagName of the HTMLElement, and `name` is the given `targetName` argument.\r\n   *\r\n   *  - Closest ascendant of the element, that matches the tagname of the\r\n   *    widget, is the specific instance of the widget itself - in other\r\n   *    words it is not nested in other widgets of the same type.\r\n   *\r\n   * @param {string} tagName - HTML element tag name\r\n   * @param {string} targetName - Widget property name\r\n   * @param {string} [selector] - Selector to find elements instead of using [data-targets]\r\n   * @param {Function} [converter] - The result converter can be used to convert the result tags, for example using templateContent\r\n   * @returns {HTMLElement[]} The HTML elements found\r\n   */\r\n  findTargets(tagName, targetName, selector = null, converter = null) {\r\n    let convert = (value) => !!converter ? converter(value) : value;\r\n    const tag = tagName.toLowerCase();\r\n    const targets = [];\r\n\r\n    if (!!selector) {\r\n      for (const el of this.querySelectorAll(selector)) {\r\n        if (el.closest(tag) === this) {\r\n          targets.push(convert(el));\r\n        }\r\n      }\r\n    }\r\n\r\n    const targetsSelector = this.createTargetsSelector(tag, targetName);\r\n\r\n    if (this.shadowRoot) {\r\n      for (const el of this.shadowRoot.querySelectorAll(targetsSelector)) {\r\n        if (!el.closest(tag)) {\r\n          targets.push(convert(el));\r\n        }\r\n      }\r\n    }\r\n\r\n    for (const el of this.querySelectorAll(targetsSelector)) {\r\n      if (el.closest(tag) === this) {\r\n        targets.push(convert(el));\r\n      }\r\n    }\r\n\r\n    return targets;\r\n  }\r\n\r\n}\r\n","/**\r\n * Throttle the execution of the function.\r\n *\r\n * You can specify the value in milliseconds as a number or in string format\r\n * with the suffix `'<delay>ms'`, supported suffixes: ms - milliseconds, s - seconds, m - minutes.\r\n *\r\n * This can be handy for \"resize\" or \"scroll\" events.\r\n *\r\n * @param {function} fn - The function to throttle.\r\n * @param {(Number|string)} delay - Delay value.\r\n * @returns {Function} The new throttled function.\r\n */\r\nexport function throttle(fn, delay) {\r\n  let throttlePause;\r\n\r\n  function throttler(...args) {\r\n    if (throttlePause) return;\r\n    throttlePause = true;\r\n\r\n    setTimeout(() => {\r\n      fn.apply(this, args);\r\n      throttlePause = false;\r\n    }, duration(delay));\r\n  }\r\n\r\n  return throttler;\r\n}\r\n\r\n/**\r\n * Debounce the execution of the function.\r\n *\r\n * You can specify the value in milliseconds as a number or in string format\r\n * with the suffix `'<delay>ms'`, supported suffixes: ms - milliseconds, s - seconds, m - minutes.\r\n *\r\n * This can be handy for events such as key presses or \"input\" in input fields.\r\n *\r\n * @param {function} fn - The function to debounce.\r\n * @param {(Number|string)} delay - Delay value.\r\n * @returns {Function} The new debounced function.\r\n */\r\nexport function debounce(fn, delay) {\r\n  let timeoutId;\r\n\r\n  function debouncer(...args) {\r\n    debouncer.clear();\r\n\r\n    timeoutId = setTimeout(() => {\r\n      timeoutId = null;\r\n\r\n      fn.apply(this, args);\r\n    }, duration(delay));\r\n  }\r\n\r\n  debouncer.clear = function() {\r\n    if (timeoutId) {\r\n      clearTimeout(timeoutId);\r\n      timeoutId = null;\r\n    }\r\n  }\r\n\r\n  return debouncer;\r\n}\r\n\r\n/**\r\n * Duration converter from human-readable form to milliseconds.\r\n *\r\n * Converts a string like `'<delay>ms'` to milliseconds.\r\n * Supported suffixes: ms - milliseconds, s - seconds, m - minutes.\r\n *\r\n * If a numeric value is passed, it is returned unchanged.\r\n *\r\n * @param {(string|Number)} value - Duration in human-readable form.\r\n * @returns {Number} - Value in milliseconds.\r\n */\r\nexport function duration(value) {\r\n  if (typeof value === 'number') {\r\n    return value;\r\n  }\r\n  if (typeof value !== 'string') {\r\n    throw new Error(`Invalid duration \"${value}\".`);\r\n  }\r\n\r\n  const duration = parseFloat(value);\r\n  if (isNaN(duration)) {\r\n    throw new Error(`Invalid duration value \"${value}\".`);\r\n  }\r\n\r\n  if (value.endsWith('ms')) {\r\n    return duration;\r\n  }\r\n  if (value.endsWith('s')) {\r\n    return duration * 1000;\r\n  }\r\n  if (value.endsWith('m')) {\r\n    return duration * 1000 * 60;\r\n  }\r\n}\r\n","\r\nexport class ListenersMap {\r\n\r\n\t#map;\r\n\r\n\tconstructor() {\r\n  \tthis.#map = new Map();\r\n  }\r\n\r\n  #normalizeKey(key) {\r\n  \treturn JSON.stringify(key);\r\n    //return key;\r\n  }\r\n\r\n  has(el, key) {\r\n  \tif (!this.#map.has(el)) return false;\r\n    return this.#map.get(el).has(this.#normalizeKey(key));\r\n  }\r\n\r\n  get(el, key) {\r\n  \tif (!this.#map.has(el)) return null;\r\n    return this.#map.get(el).get(this.#normalizeKey(key));\r\n  }\r\n\r\n  set(el, key, value) {\r\n  \tconst listeners = this.#map.get(el) || new Map();\r\n\t\tconst normalizedKey = this.#normalizeKey(key);\r\n    listeners.set(normalizedKey, value);\r\n    this.#map.set(el, listeners);\r\n  }\r\n\r\n  delete(el, key) {\r\n  \tif (!this.#map.has(el)) return null;\r\n    return this.#map.get(el).delete(this.#normalizeKey(key));\r\n  }\r\n\r\n  clear() {\r\n    this.#map = new Map();\r\n  }\r\n\r\n  *[Symbol.iterator]() {\r\n  \tfor (const [el, listeners] of this.#map) {\r\n    \tfor (const [key, listener] of listeners) {\r\n      \tyield [el, key, listener];\r\n      }\r\n    }\r\n  }\r\n\r\n}\r\n\r\n","import { LitWidgetBase } from '../lit-widget-base';\r\nimport { throttle, debounce } from '../tools/debounce';\r\nimport { ListenersMap } from '../tools/listeners-map';\r\n\r\nclass EventHandler {\r\n\r\n  constructor(eventName, handler) {\r\n    this.eventName = eventName;\r\n    this.handler = handler;\r\n  }\r\n\r\n  addListener(el) {\r\n    el.addEventListener(this.eventName, this.handler);\r\n  }\r\n\r\n  removeListener(el) {\r\n    el.removeEventListener(this.eventName, this.handler);\r\n  }\r\n\r\n}\r\n\r\n/**\r\n * TODO:\r\n */\r\nexport class EventsController {\r\n\r\n  host;\r\n\r\n  observer;\r\n\r\n  listeners = new ListenersMap();\r\n\r\n  constructor(host, events) {\r\n    if (!(host instanceof LitWidgetBase)) {\r\n      throw new Error('[LitWidget.EventsController]: The host is not an instance of the LitWidget class.');\r\n    }\r\n\r\n    this.host = host;\r\n    this.tagName = this.host.tagName.toLowerCase();\r\n    this.events = this.prepareEvents(events);\r\n\r\n    // console.log('Events:', this.events);\r\n\r\n    this.host.addController(this);\r\n  }\r\n\r\n  prepareEvents(events) {\r\n    let targetedEvents = new Map();\r\n\r\n    for (const event of events) {\r\n      let target;\r\n      if ((event.target instanceof HTMLElement) || (event.target instanceof Document) || (event.target instanceof Window)) {\r\n        target = {type: 'element', element: event.target};\r\n      } else {\r\n        if (typeof event.target === 'string') {\r\n          target = {type: 'target', target: event.target, selector: event.selector};\r\n        } else {\r\n          throw new Error(`[LitWidget.EventsController]: Invalid event definition: ${JSON.stringify(event)}.`);\r\n        }\r\n      }\r\n\r\n      targetedEvents.set(target, event);\r\n    }\r\n\r\n    // console.log('Targeted events:', targetedEvents);\r\n\r\n    return targetedEvents;\r\n  }\r\n\r\n  hostConnected() {\r\n    // console.log('[!] EventsController connected');\r\n\r\n    // Bind [type=element] events to elements\r\n    this.bindElementsEvents();\r\n\r\n    // Bind element events to targets\r\n    this.bindTargetElements(this.host);\r\n\r\n    // Observe shadowRoot and element\r\n    this.listen([this.host.shadowRoot, this.host]);\r\n  }\r\n\r\n  hostDisconnected() {\r\n    // console.log('[!] EventsController disconnected');\r\n\r\n    // Disconnect observer\r\n    this.observer?.disconnect();\r\n    this.observer = null;\r\n\r\n    // Remove elements listeners\r\n    for (const [element, target, handler] of this.listeners) {\r\n      handler.removeListener(element);\r\n    }\r\n    this.listeners.clear();\r\n  }\r\n\r\n  createHandler(event) {\r\n    // Event name\r\n    let eventName = event.event;\r\n\r\n    // Add listeners if attribute added\r\n    let handler = (...args) => event.handler.apply(this.host, args);\r\n\r\n    // Handling debounce, etc...\r\n    if (event.debounce) {\r\n      handler = debounce(handler, event.debounce);\r\n    } else if (event.throttle) {\r\n      handler = throttle(handler, event.throttle);\r\n    }\r\n    if (event['wrapper'] != null && typeof event['wrapper'] !== 'undefined') {\r\n      handler = event.wrapper.call(this.host, handler/*, this.host*/);\r\n    }\r\n\r\n    // Handling delegated event\r\n    if (typeof event.selector == 'string') {\r\n      handler = (() => {\r\n        const prevHandler = handler;\r\n        return (e) => {\r\n          if (e.target.matches(event.selector)) {\r\n            prevHandler(e);\r\n          }\r\n        };\r\n      })();\r\n    }\r\n\r\n    // Handle conditional event (eventName = {eventHandler: string, isMatch: function})\r\n    if (typeof eventName == 'object') {\r\n      const preset = eventName;\r\n      if ((preset.eventName == null) || (typeof preset.isMatch !== 'function')) {\r\n        throw new Error(`[LitWidget.EventsController]: Invalid conditional event: ${preset}`);\r\n      }\r\n\r\n      // Extract eventName from preset\r\n      eventName = preset.eventName;\r\n\r\n      // Wrap handler\r\n      handler = (() => {\r\n        const isMatch = preset.isMatch;\r\n        const prevHandler = handler;\r\n        return (e) => {\r\n          if (isMatch(e)) {\r\n            prevHandler(e);\r\n          }\r\n        };\r\n      })();\r\n\r\n    }\r\n\r\n    // Create event handler\r\n    const eventHandler = new EventHandler(eventName, handler);\r\n\r\n    return eventHandler;\r\n  }\r\n\r\n  bindElementsEvents() {\r\n    for (const [eventInfo, event] of this.events) {\r\n      if (eventInfo.type !== 'element') continue;\r\n\r\n      const key = {element: eventInfo.element, target: eventInfo};\r\n      if (this.listeners.has(eventInfo.element, key)) continue;\r\n\r\n      // Create event handler\r\n      const eventHandler = this.createHandler(event);\r\n\r\n      // Add listener to element\r\n      eventHandler.addListener(eventInfo.element);\r\n\r\n      // Store element's event handler\r\n      this.listeners.set(eventInfo.element, key, eventHandler);\r\n    }\r\n  }\r\n\r\n  bindEvents(el, oldAttrValue) {\r\n    // console.log('Bind actions:', el);\r\n\r\n    // for (const event of this.events) {\r\n    for (const [eventInfo, event] of this.events) {\r\n      if (eventInfo.type !== 'target') continue;\r\n\r\n      const isMatch = this.host.targetMatches(el, this.tagName, eventInfo.target) || this.host.targetsMatches(el, this.tagName, eventInfo.target);\r\n      const isOldMatch = !isMatch && (oldAttrValue == this.host.createTargetPath(this.tagName, eventInfo.target));\r\n      const key = {element: el, id: event.id};\r\n\r\n      if (isMatch) {\r\n        if (this.listeners.has(el, key)) continue;\r\n\r\n        // console.log('Bind [3] (+):', key, el, event);\r\n\r\n        // Skip nested (Shadow DOM Only!)\r\n        const isShadowNode = el.getRootNode() === this.host.shadowRoot;\r\n        if (isShadowNode && el.closest(this.tagName)) continue;\r\n\r\n        // Create event handler\r\n        const eventHandler = this.createHandler(event);\r\n\r\n        // Add listener to element\r\n        eventHandler.addListener(el);\r\n\r\n        // Store element's event handler\r\n        this.listeners.set(el, key, eventHandler);\r\n      } else if (isOldMatch) {\r\n        if (!this.listeners.has(el, key)) continue;\r\n\r\n        // console.log('Bind [3] (-):', key, el, event);\r\n\r\n        // Remove listeners if attribute removed\r\n        const handler = this.listeners.get(el, key);\r\n        handler?.removeListener(el);\r\n\r\n        // Remove element from listeners map\r\n        this.listeners.delete(el, key);\r\n      }\r\n    }\r\n  }\r\n\r\n  bindTargetElements(root) {\r\n    // Bind controller's targets\r\n    for (const el of root.querySelectorAll(`[${this.host.targetAttribute}],[${this.host.targetsAttribute}]`)) {\r\n      this.bindEvents(el);\r\n    }\r\n\r\n    // Also bind the controller to itself\r\n    if (root instanceof Element && (root.hasAttribute(this.host.targetAttribute) || root.hasAttribute(this.host.targetsAttribute))) {\r\n      this.bindEvents(root);\r\n    }\r\n  }\r\n\r\n  listen(els) {\r\n    if (!this.observer) {\r\n      // Create observer\r\n      this.observer = new MutationObserver(mutations => {\r\n        for (const mutation of mutations) {\r\n          if (mutation.type === 'attributes' && mutation.target instanceof Element) {\r\n            this.bindEvents(mutation.target, mutation.oldValue);\r\n          } else if (mutation.type === 'childList' && mutation.addedNodes.length) {\r\n            for (const node of mutation.addedNodes) {\r\n              if (node instanceof Element) {\r\n                this.bindTargetElements(node);\r\n              }\r\n            }\r\n          }\r\n        }\r\n      });\r\n    }\r\n\r\n    // Observe elements\r\n    for (const el of els) {\r\n      if (el == null) continue;\r\n\r\n      this.observer.observe(\r\n        el,\r\n        {\r\n          childList: true,\r\n          subtree: true,\r\n          attributeFilter: [\r\n            this.host.targetAttribute,\r\n            this.host.targetsAttribute,\r\n          ],\r\n          attributeOldValue : true,\r\n        }\r\n      );\r\n    }\r\n  }\r\n\r\n}\r\n","\r\nclass DocumentStylesObserver {\r\n\r\n  document;\r\n\r\n  observer;\r\n\r\n  observing;\r\n\r\n  listeners;\r\n\r\n  constructor(document) {\r\n    this.document = document;\r\n    this.listeners = new Set();\r\n    this.observing = false;\r\n\r\n    this.observer = new MutationObserver(mutations => {\r\n      for (const mutation of mutations) {\r\n        if (mutation.type === 'childList' && (mutation.addedNodes.length || mutation.removedNodes.length)) {\r\n          // console.log('! [+]', mutation.addedNodes);\r\n          // console.log('! [-]', mutation.removedNodes);\r\n\r\n          for (const node of mutation.addedNodes) {\r\n            if (node instanceof Element) {\r\n              const tagName = node.tagName.toLowerCase();\r\n              if ((tagName == 'style') || (tagName == 'link' && node.getAttribute('rel') == 'stylesheet')) {\r\n                this.notifyListeners({type: 'add', node});\r\n              }\r\n            }\r\n          }\r\n\r\n          for (const node of mutation.removedNodes) {\r\n            if (node instanceof Element) {\r\n              const tagName = node.tagName.toLowerCase();\r\n              if ((tagName == 'style') || (tagName == 'link' && node.getAttribute('rel') == 'stylesheet')) {\r\n                this.notifyListeners({type: 'remove', node});\r\n              }\r\n            }\r\n          }\r\n\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  observe() {\r\n    if (this.observing) return;\r\n\r\n    this.observer.observe(\r\n      this.document.head,\r\n      {\r\n        childList: true,\r\n        subtree: true,\r\n      }\r\n    );\r\n\r\n    this.observing = true;\r\n  }\r\n\r\n  disconnect() {\r\n    if (!this.observing) return;\r\n\r\n    this.observer.takeRecords();\r\n    this.observer.disconnect();\r\n\r\n    this.observing = false;\r\n  }\r\n\r\n  addListener(fn) {\r\n    this.listeners.add(fn);\r\n    if (this.listeners.size > 0) {\r\n      this.observe();\r\n    }\r\n  }\r\n\r\n  removeListener(fn) {\r\n    this.listeners.delete(fn);\r\n    if (this.listeners.size == 0) {\r\n      this.disconnect();\r\n    }\r\n  }\r\n\r\n  notifyListeners(operation) {\r\n    for (const listener of this.listeners) {\r\n      listener(operation);\r\n    }\r\n  }\r\n\r\n}\r\n\r\n/**\r\n * TODO:\r\n */\r\nexport class SharedStylesController {\r\n\r\n  host;\r\n\r\n  static observer;\r\n\r\n  initialized = false;\r\n\r\n  styleRoot;\r\n  styles = new WeakMap();\r\n\r\n  constructor(host, sharedStyles) {\r\n    if (sharedStyles) {\r\n      this.host = host;\r\n      this.host.addController(this);\r\n      this.stylesUpdated = (o) => this.updated(o);\r\n    }\r\n  }\r\n\r\n  hostConnected() {\r\n    const shadowRoot = this.host.shadowRoot != null;\r\n\r\n    if (!this.initialized) {\r\n      this.initialized = true;\r\n\r\n      const root = this.host.renderRoot;\r\n      const document = this.host.ownerDocument;\r\n\r\n      if (shadowRoot) {\r\n        // Import styles\r\n        for (const style of document.head.querySelectorAll('style')) {\r\n          this.addStyle(style, root);\r\n        }\r\n\r\n        // Import link[stylesheet]\r\n        for (const style of document.head.querySelectorAll('link[rel=\"stylesheet\"]')) {\r\n          this.addStyle(style, root);\r\n        }\r\n      }\r\n    }\r\n\r\n    if (shadowRoot) {\r\n      this.startObserving();\r\n    }\r\n  }\r\n\r\n  addStyle(style, root = null) {\r\n    // Skip non-shared styles\r\n    if (style.getAttribute('data-shared') == 'false') return;\r\n\r\n    if (root == null) root = this.host.renderRoot;\r\n\r\n    // Create styleRoot\r\n    if (this.styleRoot == null) {\r\n      this.styleRoot = this.host.ownerDocument.createElement('shared-styles--');\r\n      root.insertBefore(this.styleRoot, root.firstChild);\r\n    }\r\n\r\n    // Cloning and adding a style\r\n    const styleClone = style.cloneNode(true);\r\n    this.styleRoot.appendChild(styleClone);\r\n\r\n    // Save the link between the style and its clone\r\n    this.styles.set(style, styleClone);\r\n  }\r\n\r\n  removeStyle(style) {\r\n    const styleClone = this.styles.get(style);\r\n    if (styleClone != null) {\r\n      styleClone.remove();\r\n      this.styles.delete(style);\r\n    }\r\n  }\r\n\r\n  hostDisconnected() {\r\n    this.stopObserving();\r\n  }\r\n\r\n  startObserving() {\r\n    // Create observer\r\n    if (SharedStylesController.observer == null) {\r\n      SharedStylesController.observer = new DocumentStylesObserver(this.host.ownerDocument);\r\n    }\r\n\r\n    // Start observing\r\n    SharedStylesController.observer.addListener(this.stylesUpdated);\r\n  }\r\n\r\n  stopObserving() {\r\n    if (SharedStylesController.observer != null) {\r\n      SharedStylesController.observer.removeListener(this.stylesUpdated);\r\n    }\r\n  }\r\n\r\n  updated({type, node}) {\r\n    switch(type) {\r\n      case 'add':\r\n        this.addStyle(node);\r\n        break;\r\n\r\n      case 'remove':\r\n        this.removeStyle(node);\r\n        break;\r\n    }\r\n  }\r\n\r\n}\r\n","import { html } from 'lit';\r\nimport { templateContent } from 'lit/directives/template-content.js';\r\nimport { EventsController } from './controllers/events-controller';\r\nimport { SharedStylesController } from './controllers/shared-styles-controller';\r\nimport { LitWidgetBase } from './lit-widget-base';\r\n\r\n/**\r\n * Declarative binding to child elements for [LitElement](https://lit.dev/)\r\n * like [Github/Catalyst](https://catalyst.rocks/) and\r\n * [Stimulus.js](https://stimulus.hotwired.dev/).\r\n *\r\n * To define a widget, subclass LitWidget, specify targets using\r\n * the `@target/@targets` decorators or the `static targets/targetsAll` property,\r\n * and add event handlers using the `@onEvent` decorator or\r\n * the `events` property.\r\n *\r\n * LitWidget unlike LitElement implements the **`render()`** method,\r\n * which renders all child elements of the widget through `<slot>`.\r\n * To change this behavior, simply override the `render` method and\r\n * implement your own rendering.\r\n *\r\n */\r\nexport class LitWidget extends LitWidgetBase {\r\n\r\n  // #region Static helpers\r\n\r\n  /** @internal */\r\n  static widget(name) {\r\n    return function(proto, options) {\r\n      LitWidget.define(name, proto, options);\r\n    }\r\n  }\r\n\r\n  /** @internal */\r\n  static define(name, constructor, options) {\r\n    customElements.define('w-' + name, constructor, options);\r\n  }\r\n\r\n  /**\r\n   * Getter helper, for getting static properties\r\n   */\r\n\tget static() {\r\n    return Object.getPrototypeOf(this).constructor;\r\n  }\r\n\r\n  // #endregion Static helpers\r\n\r\n  // #region Default render\r\n\r\n  /**\r\n   * Default renderer, renders Light DOM\r\n   */\r\n  render() {\r\n    return html`<slot></slot>`;\r\n  }\r\n\r\n  // #endregion Default render\r\n\r\n  // #region Default values\r\n\r\n  static defaultValues = {}\r\n\r\n  get defaultValues() {\r\n    if (this._defaultValues != null) {\r\n      return this._defaultValues;\r\n    }\r\n\r\n    // const parentDefaultValues = (this instanceof LitWidget) ? {} : Object.getPrototypeOf(this).defaultValues;\r\n    const parentDefaultValues = Object.getPrototypeOf(this).defaultValues ?? {};\r\n    this._defaultValues = {\r\n      ...parentDefaultValues,\r\n      ...this.constructor.defaultValues,\r\n    };\r\n\r\n    return this._defaultValues;\r\n  }\r\n\r\n  // #endregion Default values\r\n\r\n  // #region Events\r\n\r\n  #events;\r\n\r\n  #prepareEvents() {\r\n    const events = [\r\n      ...(this._events || []),\r\n      ...(this.events || []),\r\n    ];\r\n\r\n  \tconst eventsDefs = events.map((event, index) => {\r\n      return {id: index, ...event};\r\n    });\r\n\r\n    // Seal events\r\n    Object.defineProperty(this, 'events', {\r\n    \tconfigurable: true,\r\n      get() {\r\n      \treturn eventsDefs;\r\n      },\r\n    });\r\n  }\r\n\r\n  // #endregion Events\r\n\r\n  // #region Shared styles\r\n\r\n  /**\r\n   * Specifies whether to import page styles into shadowRoot.\r\n   */\r\n  static sharedStyles = null\r\n\r\n  /**\r\n   * @internal\r\n   */\r\n  get sharedStyles() {\r\n    let sharedStyles = this.static.sharedStyles;\r\n\r\n    // Treat null as auto\r\n    if ((sharedStyles == null) && !this.lightDOM) {\r\n      // If sharedStyles is \"auto\" and not lightDOM - then it will default to true\r\n      sharedStyles = true;\r\n    }\r\n\r\n    return sharedStyles;\r\n  }\r\n\r\n  #sharedStylesController = new SharedStylesController(this, this.sharedStyles);\r\n\r\n  // #endregion Shared styles\r\n\r\n  // #region Light DOM\r\n\r\n  /**\r\n   * Enables the use of Light DOM in the component.\r\n   *\r\n   * The renderRoot will be the component element or its child element\r\n   * with the `data-root=\"component-tag-name\"` attribute.\r\n   *\r\n   * @type {boolean}\r\n   */\r\n  static lightDOM = false\r\n\r\n  /**\r\n   * @internal\r\n   */\r\n  get lightDOM() {\r\n    return this.static.lightDOM;\r\n  }\r\n\r\n  createRenderRoot() {\r\n    let root;\r\n    const tagName = this.tagName.toLowerCase();\r\n\r\n    if (this.lightDOM) {\r\n      // Find light DOM root [data-root]\r\n      let rootElement = this.querySelector(`[data-root=\"${tagName}\"]`);\r\n\r\n      // If the nearest root target found is not the element itself,\r\n      // ignore it (to avoid using the root target in a nested same widget)\r\n      if (rootElement != null && rootElement.closest(tagName) != this) {\r\n        rootElement = null;\r\n      }\r\n\r\n      // Use found root target or element itself as renderRoot\r\n      root = rootElement ?? this;\r\n    } else {\r\n      root = super.createRenderRoot();\r\n    }\r\n\r\n    if (this.lightDOM && this.sharedStyles === true) {\r\n      console.warn(`[LitWidget \"${tagName}\"] Shared styles (sharedStyles = true) with lightDOM have no effect.`);\r\n    }\r\n\r\n    return root;\r\n  }\r\n\r\n  // #endregion Light DOM\r\n\r\n  // #region Lifecycle\r\n\r\n  connectedCallback() {\r\n    if (!this.#events) {\r\n      this.#prepareEvents();\r\n      this.#events = new EventsController(this, this.events);\r\n    }\r\n\r\n    super.connectedCallback();\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    super.disconnectedCallback();\r\n\r\n    if (typeof this._findCache !== 'undefined') {\r\n      this._findCache = {};\r\n    }\r\n  }\r\n\r\n  // #endregion Lifecycle\r\n\r\n}\r\n\r\n// #region Targets getters\r\n\r\nLitWidget.addInitializer((instance) => {\r\n  const klass = Object.getPrototypeOf(instance).constructor;\r\n\r\n  if (typeof klass.targets !== 'undefined') {\r\n    for (const [target, options] of Object.entries(klass.targets)) {\r\n      // Add target getter\r\n      Object.defineProperty(instance, options.property ?? target, {\r\n        configurable: true,\r\n        get() {\r\n          if (typeof this._findCache === 'undefined') {\r\n            this._findCache = {};\r\n          }\r\n\r\n          const cache = options.cache ?? true;\r\n\r\n          if (cache && this._findCache[target]) {\r\n            return this._findCache[target];\r\n          } else {\r\n            let targetElement = this._findCache[target] ??= this.findTarget(this.tagName, target, options.selector);\r\n            if (targetElement == null) {\r\n              console.error(`[LitWidget \"${klass.name}\"] Target \"${target}\" not found.`);\r\n            } else {\r\n              const convertTemplate = (options.template === true) || ((targetElement.tagName.toLowerCase() == 'template') && (options.template !== false));\r\n              if (convertTemplate) {\r\n                targetElement = templateContent(targetElement);\r\n              }\r\n              this._findCache[target] = targetElement;\r\n            }\r\n            return targetElement;\r\n          }\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  if (typeof klass.targetsAll !== 'undefined') {\r\n    for (const [target, options] of Object.entries(klass.targetsAll)) {\r\n      // Add target getter\r\n      Object.defineProperty(instance, options.property ?? target, {\r\n        configurable: true,\r\n        get() {\r\n          if (typeof this._findAllCache === 'undefined') {\r\n            this._findAllCache = {};\r\n          }\r\n\r\n          const cache = options.cache ?? true;\r\n\r\n          if (cache && this._findAllCache[target]) {\r\n            return this._findAllCache[target];\r\n          } else {\r\n            const targetElements = this._findAllCache[target] ??= this.findTargets(this.tagName, target, options.selector);\r\n            return targetElements;\r\n          }\r\n\r\n          // return this._findAllCache[target] ??= this.findTargets(this.tagName, target, options.selector);\r\n        }\r\n      });\r\n    }\r\n  }\r\n});\r\n\r\n// #endregion Targets getters\r\n","import { LitWidget } from './lit-widget';\r\n\r\n/**\r\n * Decorator to bind a property to a child HTML element\r\n *\r\n * ```js\r\n * class SampleWidget extends LitWidget {\r\n *\r\n *   @target button;\r\n *\r\n * }\r\n * ```\r\n *\r\n * By default, it binds to a child element with the `data-target` attribute equal to\r\n * the component's tag name and the name of the property connected by a dot,\r\n * like this - `tag-name.property-name`.\r\n *\r\n * The element is first looked up in renderRoot and then in the component tag itself.\r\n *\r\n * If a CSS selector is specified, the element with the matching selector\r\n * is searched for only among the child elements of the component tag.\r\n *\r\n * If the element being bound is the `<template>` tag, then by default\r\n * automatic conversion takes place using the Lit's directive `templateContent`.\r\n * To disable this behavior - you must specify `template: false`.\r\n *\r\n * @param {{name: string, selector: string, cache: Boolean, template: Boolean}} options - Optional parameters for binding.\r\n * @param {string} options.name - Target name to find the element to which the property will be bound.\r\n * @param {string} options.selector - CSS selector to find the element to which the property will be bound.\r\n * @param {Boolean} options.cache - Should the bind operation be cached or search for an element each time it is accessed?\r\n * @param {Boolean} options.template - Controls how the `<template>` tag is converted when bound.\r\n */\r\nexport function target({ name, selector, cache, template } = {}, propertyName = null) {\r\n  const wrapper = function(instance, property) {\r\n    const klass = instance.constructor;\r\n    if (!(instance instanceof LitWidget)) {\r\n      throw new Error(`[LitWidget] The class \"${klass.name}\" is not a descendant of LitWidget.`);\r\n    }\r\n\r\n    if (typeof klass.targets === 'undefined') {\r\n      klass.targets = {};\r\n    }\r\n    klass.targets[name ?? property] = {property, selector, cache, template};\r\n  };\r\n\r\n  if (propertyName == null) {\r\n    return wrapper;\r\n  } else {\r\n    const instance = arguments[0];\r\n    wrapper(instance, propertyName);\r\n  }\r\n}\r\n\r\n/**\r\n * Decorator to bind a property to an array of HTML child elements\r\n *\r\n * ```js\r\n * class SampleWidget extends LitWidget {\r\n *\r\n *   @targets emailEntries;\r\n *\r\n * }\r\n * ```\r\n *\r\n * By default, it binds to an array of child elements with a `data-targets`\r\n * attribute equal to the component's tag name and the name of the property\r\n * connected by a dot, like this - `tag-name.property-name`.\r\n *\r\n * Elements are looked up in renderRoot and in the component tag itself.\r\n *\r\n * If a CSS selector is specified, all elements with the matching selector\r\n * are searched only among the child elements of the component tag.\r\n *\r\n * @param {{name: string, selector: string, cache: Boolean}} options - Optional parameters for binding.\r\n * @param {string} options.name - Target name to find the elements to which the property will be bound.\r\n * @param {string} options.selector - CSS selector to find the elements to which the property will be bound.\r\n * @param {Boolean} options.cache - Should the bind operation be cached or search for an element each time it is accessed?\r\n */\r\nexport function targets({ name, selector, cache } = {}, propertyName = null) {\r\n  const wrapper = function(instance, property) {\r\n    const klass = instance.constructor;\r\n    if (!(instance instanceof LitWidget)) {\r\n      throw new Error(`[LitWidget] The class \"${klass.name}\" is not a descendant of LitWidget.`);\r\n    }\r\n\r\n    if (typeof klass.targetsAll === 'undefined') {\r\n      klass.targetsAll = {};\r\n    }\r\n    klass.targetsAll[name ?? property] = {property, selector, cache};\r\n  };\r\n\r\n  if (propertyName == null) {\r\n    return wrapper;\r\n  } else {\r\n    const instance = arguments[0];\r\n    wrapper(instance, propertyName);\r\n  }\r\n}\r\n\r\n/**\r\n * Decorator to attach a method as an HTML child element event handler\r\n *\r\n * ```js\r\n * class SampleWidget extends LitWidget {\r\n *\r\n *   @onEvent('button', 'click')\r\n *   greet(event) {\r\n *     ...\r\n *   }\r\n *\r\n * }\r\n * ```\r\n *\r\n * @param {(string|Window|Document|HTMLElement)} target - The name of the target to find the HTML element.\r\n *     You can pass an existing HTML element or window to attach an event handler to document.body or window for example.\r\n * @param {string|{eventName: string, isMatch: function}} event - The name of the DOM event to which the handler is attached.\r\n * @param {{selector: string, debounce: (Number|string), throttle: (Number|string), wrapper: function(function, this)}} options - Optional parameters for attaching an event.\r\n * @param {string} options.selector - This parameter allows you to filter the triggering of delegated events by CSS selector.\r\n * @param {string|number} options.debounce - Delay to debounce the execution of the event handler,\r\n *     you can specify the value in milliseconds as a number or in string format\r\n *     with the suffix `'<delay>ms'`, supported suffixes: ms - milliseconds, s - seconds, m - minutes.\r\n *     This can be handy for events such as key presses or \"input\" in input fields.\r\n * @param {string|number} options.throttle - Delay to throttle the execution of the event handler,\r\n *     you can specify the value in milliseconds as a number or in string format\r\n *     with the suffix `'<delay>ms'`, supported suffixes: ms - milliseconds, s - seconds, m - minutes.\r\n *     This can be handy for \"resize\" or \"scroll\" events.\r\n * @param {function} options.wrapper - Wrapper function to apply additional decorators to the event handler;\r\n *     can be useful for example to apply a debounce decorator with a delay set at runtime:\r\n *     `onEvent(..., wrapper: (fn, self) => debounce(fn, self.delay) )`.\r\n *     The first parameter in the wrapper is the event handler method,\r\n *     the second is a reference to the class instance.\r\n */\r\nexport function onEvent(target, event, { selector, debounce, throttle, wrapper } = {}) {\r\n  return function(instance, property) {\r\n    const klass = instance.constructor;\r\n    if (!(instance instanceof LitWidget)) {\r\n      throw new Error(`[LitWidget] The class \"${klass.name}\" is not a descendant of LitWidget.`);\r\n    }\r\n\r\n    if (typeof instance._events === 'undefined') {\r\n      instance._events = [];\r\n    }\r\n\r\n    instance._events.push({\r\n      target,\r\n      handler: instance[property],\r\n      event,\r\n      selector,\r\n      debounce,\r\n      throttle,\r\n      wrapper,\r\n    });\r\n  };\r\n}\r\n"],"names":["LitWidgetBase","createTargetPath","tagName","targetName","toLowerCase","createTargetSelector","tag","targetAttribute","createTargetsSelector","targetsAttribute","targetMatches","el","selector","matches","targetsMatches","findTarget","converter","convert","value","_create_for_of_iterator_helper_loose","querySelectorAll","closest","targetSelector","shadowRoot","findTargets","targets","push","targetsSelector","LitElement","throttle","fn","delay","throttlePause","args","setTimeout","apply","duration","debounce","timeoutId","debouncer","clear","clearTimeout","Error","parseFloat","isNaN","endsWith","_class_private_field_loose_key","Symbol","iterator","ListenersMap","_class_private_field_loose_base","map","Map","has","key","get","normalizeKey","set","listeners","normalizedKey","delete","JSON","stringify","EventHandler","eventName","handler","addListener","addEventListener","removeListener","removeEventListener","EventsController","host","events","_instanceof","prepareEvents","addController","targetedEvents","event","target","HTMLElement","Document","Window","type","element","hostConnected","bindElementsEvents","bindTargetElements","listen","hostDisconnected","observer","disconnect","createHandler","wrapper","call","prevHandler","e","isMatch","preset","eventInfo","eventHandler","bindEvents","oldAttrValue","isOldMatch","id","isShadowNode","getRootNode","root","Element","hasAttribute","els","MutationObserver","mutations","mutation","oldValue","addedNodes","length","node","observe","childList","subtree","attributeFilter","attributeOldValue","DocumentStylesObserver","document","Set","observing","removedNodes","getAttribute","notifyListeners","head","takeRecords","add","size","operation","listener","SharedStylesController","sharedStyles","initialized","styles","WeakMap","stylesUpdated","o","updated","renderRoot","ownerDocument","style","addStyle","startObserving","styleRoot","createElement","insertBefore","firstChild","styleClone","cloneNode","appendChild","removeStyle","remove","stopObserving","LitWidget","sharedStylesController","render","html","createRenderRoot","lightDOM","rootElement","querySelector","console","warn","connectedCallback","disconnectedCallback","_findCache","widget","name","proto","options","define","constructor","customElements","static","Object","getPrototypeOf","defaultValues","_defaultValues","parentDefaultValues","eventsDefs","_events","index","defineProperty","configurable","addInitializer","instance","klass","entries","property","cache","targetElement","error","template","templateContent","targetsAll","_findAllCache","propertyName","arguments","onEvent"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAEO,IAAA,aAAMA,GA8HZ,SA9HM,UAAA,EAAA;EAAMA,IAAAA,SAAAA,aAAAA,GAAAA;;;;;;;;;;;;EAAAA,KAAAA,CAAAA,aAAAA,EAAAA,UAAAA,CAAAA,CAAAA;EAAAA,IAAAA,IAAAA,MAAAA,GAAAA,aAAAA,CAAAA,UAAAA;EAUXC,IAAAA,OAAAA,MAAAA,CAAAA,gBAGC,GAHDA,SAAiBC,OAAO,EAAEC,UAAU,EAAA;EAElC,QAAA,OAAO,OADKD,CAAQE,WAAW,EAAA,GACjB,GAAGD,GAAAA,UAAAA,CAAAA;EACnB,KAAA,EAEAE,OAAAA,oBAGC,GAHDA,SAAqBH,OAAO,EAAEC,UAAU,EAAA;UACtC,IAAMG,GAAAA,GAAMJ,QAAQE,WAAW,EAAA,CAAA;UAC/B,OAAQ,MAAG,IAAI,CAACG,eAAe,GAAC,KAAA,GAAKD,GAAI,GAAA,GAAA,GAAGH,UAAW,GAAA,IAAA,CAAA;EACzD,KAAA,EAEAK,OAAAA,qBAGC,GAHDA,SAAsBN,OAAO,EAAEC,UAAU,EAAA;UACvC,IAAMG,GAAAA,GAAMJ,QAAQE,WAAW,EAAA,CAAA;UAC/B,OAAQ,MAAG,IAAI,CAACK,gBAAgB,GAAC,KAAA,GAAKH,GAAI,GAAA,GAAA,GAAGH,UAAW,GAAA,IAAA,CAAA;OAG1DO,EAAAA,MAAAA,CAAAA,aAGC,GAHDA,SAAcC,EAAE,EAAET,OAAO,EAAEC,UAAU,EAAA;EACnC,QAAA,IAAMS,QAAW,GAAA,IAAI,CAACP,oBAAoB,CAACH,OAASC,EAAAA,UAAAA,CAAAA,CAAAA;UACpD,OAAOQ,EAAAA,CAAGE,OAAO,CAACD,QAAAA,CAAAA,CAAAA;OAGpBE,EAAAA,MAAAA,CAAAA,cAGC,GAHDA,SAAeH,EAAE,EAAET,OAAO,EAAEC,UAAU,EAAA;EACpC,QAAA,IAAMS,QAAW,GAAA,IAAI,CAACJ,qBAAqB,CAACN,OAASC,EAAAA,UAAAA,CAAAA,CAAAA;UACrD,OAAOQ,EAAAA,CAAGE,OAAO,CAACD,QAAAA,CAAAA,CAAAA;OAGpB;;;;;;;;;;;;;;;;QAiBAG,MAAAA,CAAAA,UAuBC,GAvBDA,SAAWb,OAAO,EAAEC,UAAU,EAAES,QAAe,EAAEI,SAAgB,EAAA;EAAjCJ,QAAAA,KAAAA,CAAAA,KAAAA,QAAAA,KAAAA,QAAW,GAAA,IAAG,cAAGI,SAAAA,KAAAA,YAAY,IAAG,CAAA,CAAA;EAC9D,QAAA,IAAIC,UAAU,SAACC,KAAAA,EAAAA;qBAAU,SAAEF,GAAYA,UAAUE,KAASA,CAAAA,GAAAA,KAAAA,CAAAA;EACpDZ,SAAAA,EAAAA,GAAAA,GAAMJ,QAAQE,WAAW,EAAA,CAAA;EAE/B,QAAA,IAAMQ,UACJ,IAAiB,IAAA,KAAA,EAAA,SAAA,GAAAO,sCAAA,CAAA,IAAI,CAACC,gBAAgB,CAACR,QAAW,CAAA,CAAA,EAAA,CAAA,CAAA,KAAA,GAAA,SAAA,EAAA,EAAA,IAAA,EAAA;EAAvCD,YAAAA,IAAAA,EAAAA,GAAAA,KAAAA,CAAAA,KAAAA,CAAAA;EACT,YAAA,IAAIA,GAAGU,OAAO,CAACf,SAAS,IAAI,EAC1B,OAAOW,OAAQN,CAAAA,EAAAA,CAAAA,CAAAA;EAEnB,SAAA;EAGF,QAAA,IAAMW,cAAiB,GAAA,IAAI,CAACjB,oBAAoB,CAACC,GAAKH,EAAAA,UAAAA,CAAAA,CAAAA;UAEtD,IAAI,IAAI,CAACoB,UAAU,EACjB,IAAA,IAAA,MAAA,EAAA,UAAA,GAAAJ,sCAAA,CAAiB,IAAI,CAACI,UAAU,CAACH,gBAAgB,CAACE,cAAiB,CAAA,CAAA,EAAA,CAAA,CAAA,MAAA,GAAA,UAAA,EAAA,EAAA,IAAA,EAAA;EAAxDX,YAAAA,IAAAA,GAAAA,GAAAA,MAAAA,CAAAA,KAAAA,CAAAA;EACT,YAAA,IAAI,CAACA,GAAGU,CAAAA,OAAO,CAACf,GAAAA,CAAAA,EAAM,OAAOW,OAAQN,CAAAA,GAAAA,CAAAA,CAAAA;EACvC,SAAA;EAGF,QAAA,IAAA,IAAA,MAAA,EAAA,UAAA,GAAAQ,sCAAA,CAAiB,IAAI,CAACC,gBAAgB,CAACE,cAAiB,CAAA,CAAA,EAAA,CAAA,CAAA,MAAA,GAAA,UAAA,EAAA,EAAA,IAAA,EAAA;EAA7CX,YAAAA,IAAAA,GAAAA,GAAAA,MAAAA,CAAAA,KAAAA,CAAAA;EACT,YAAA,IAAIA,IAAGU,OAAO,CAACf,SAAS,IAAI,EAAE,OAAOW,OAAQN,CAAAA,GAAAA,CAAAA,CAAAA;EAC/C,SAAA;OAGF;;;;;;;;;;;;;;;;QAiBAa,MAAAA,CAAAA,WA8BC,GA9BDA,SAAYtB,OAAO,EAAEC,UAAU,EAAES,QAAe,EAAEI,SAAgB,EAAA;EAAjCJ,QAAAA,KAAAA,CAAAA,KAAAA,QAAAA,KAAAA,QAAW,GAAA,IAAG,cAAGI,SAAAA,KAAAA,YAAY,IAAG,CAAA,CAAA;EAC/D,QAAA,IAAIC,UAAU,SAACC,KAAAA,EAAAA;qBAAU,SAAEF,GAAYA,UAAUE,KAASA,CAAAA,GAAAA,KAAAA,CAAAA;EACpDZ,SAAAA,EAAAA,GAAAA,GAAMJ,OAAQE,CAAAA,WAAW,EACzBqB,EAAAA,OAAAA,GAAU,EAAE,CAAA;EAElB,QAAA,IAAMb,UACJ,IAAiB,IAAA,KAAA,EAAA,SAAA,GAAAO,sCAAA,CAAA,IAAI,CAACC,gBAAgB,CAACR,QAAW,CAAA,CAAA,EAAA,CAAA,CAAA,KAAA,GAAA,SAAA,EAAA,EAAA,IAAA,EAAA;EAAvCD,YAAAA,IAAAA,EAAAA,GAAAA,KAAAA,CAAAA,KAAAA,CAAAA;cACLA,EAAGU,CAAAA,OAAO,CAACf,GAAS,CAAA,KAAA,IAAI,IAC1BmB,OAAQC,CAAAA,IAAI,CAACT,OAAQN,CAAAA,EAAAA,CAAAA,CAAAA,CAAAA;EAEzB,SAAA;EAGF,QAAA,IAAMgB,eAAkB,GAAA,IAAI,CAACnB,qBAAqB,CAACF,GAAKH,EAAAA,UAAAA,CAAAA,CAAAA;UAExD,IAAI,IAAI,CAACoB,UAAU,EACjB,IAAA,IAAA,MAAA,EAAA,UAAA,GAAAJ,sCAAA,CAAiB,IAAI,CAACI,UAAU,CAACH,gBAAgB,CAACO,eAAkB,CAAA,CAAA,EAAA,CAAA,CAAA,MAAA,GAAA,UAAA,EAAA,EAAA,IAAA,EAAA;EAAzDhB,YAAAA,IAAAA,GAAAA,GAAAA,MAAAA,CAAAA,KAAAA,CAAAA;EACJA,YAAAA,GAAAA,CAAGU,OAAO,CAACf,GAAAA,CAAAA,IACdmB,OAAQC,CAAAA,IAAI,CAACT,OAAQN,CAAAA,GAAAA,CAAAA,CAAAA,CAAAA;EAEzB,SAAA;EAGF,QAAA,IAAA,IAAA,MAAA,EAAA,UAAA,GAAAQ,sCAAA,CAAiB,IAAI,CAACC,gBAAgB,CAACO,eAAkB,CAAA,CAAA,EAAA,CAAA,CAAA,MAAA,GAAA,UAAA,EAAA,EAAA,IAAA,EAAA;EAA9ChB,YAAAA,IAAAA,GAAAA,GAAAA,MAAAA,CAAAA,KAAAA,CAAAA;cACLA,GAAGU,CAAAA,OAAO,CAACf,GAAS,CAAA,KAAA,IAAI,IAC1BmB,OAAQC,CAAAA,IAAI,CAACT,OAAQN,CAAAA,GAAAA,CAAAA,CAAAA,CAAAA;EAEzB,SAAA;UAEA,OAAOc,OAAAA,CAAAA;OA3HEzB,EAAAA,mBAAAA,CAAAA,aAAAA,CAAAA,SAAAA,EAAAA;;cAEPO,GAAAA,EAAAA,iBAAAA;EAAJ,YAAA,GAAA,EAAA,WAAA;kBACE,OAAO,aAAA,CAAA;EACT,aAAA;;;cAEIE,GAAAA,EAAAA,kBAAAA;EAAJ,YAAA,GAAA,EAAA,WAAA;kBACE,OAAO,cAAA,CAAA;EACT,aAAA;;UARWT,aAAAA,CAAAA;IAAsB4B,cA8HlC,CAAA;;EChID;;;;;;;;;;;EAWC,IACM,SAASC,QAASC,CAAAA,EAAE,EAAEC,KAAK,EAAA;EAC5BC,IAAAA,IAAAA,aAAAA,CAAAA;MAYJ,OAVA,WAAA;EAAmB,QAAA,IAAA,IAAA,IAAA,GAAA,SAAA,CAAA,MAAA,EAAGC,OAAH,KAAA,CAAA,IAAA,CAAA,EAAA,IAAA,GAAA,CAAA,EAAA,OAAA,IAAA,EAAA,IAAA,EAAA,CAAGA,KAAH,IAAA,CAAA,GAAA,SAAA,CAAA,IAAO,CAAA,CAAA;;UACpBD,aACJA,KAAAA,aAAAA,GAAgB,CAAA,CAAA,EAEhBE,UAAW,CAAA,WAAA;EACTJ,YAAAA,EAAAA,CAAGK,KAAK,CAAA,KAAA,EAAOF,IACfD,CAAAA,EAAAA,aAAAA,GAAgB,CAAA,CAAA,CAAA;EAClB,SAAA,EAAGI,QAASL,CAAAA,KAAAA,CAAAA,CAAAA,CAAAA,CAAAA;EACd,KAAA,CAAA;EAGF,CAAA;EAEA;;;;;;;;;;;EAWC,IACM,SAASM,QAASP,CAAAA,EAAE,EAAEC,KAAK,EAAA;MAChC,IAAIO,SAAAA,CAAAA;MAEJ,SAASC,SAAAA,GAAAA;EAAU,QAAA,IAAA,IAAA,IAAA,GAAA,SAAA,CAAA,MAAA,EAAGN,OAAH,KAAA,CAAA,IAAA,CAAA,EAAA,IAAA,GAAA,CAAA,EAAA,OAAA,IAAA,EAAA,IAAA,EAAA,CAAGA,KAAH,IAAA,CAAA,GAAA,SAAA,CAAA,IAAO,CAAA,CAAA;;UACxBM,SAAUC,CAAAA,KAAK,EAEfF,EAAAA,SAAAA,GAAYJ,UAAW,CAAA,WAAA;cACrBI,SAAY,GAAA,IAAA,EAEZR,EAAGK,CAAAA,KAAK,CAAOF,KAAAA,EAAAA,IAAAA,CAAAA,CAAAA;EACjB,SAAA,EAAGG,QAASL,CAAAA,KAAAA,CAAAA,CAAAA,CAAAA;EACd,KAAA;MASA,OAPAQ,SAAAA,CAAUC,KAAK,GAAG,WAAA;UACZF,SACFG,KAAAA,YAAAA,CAAaH,YACbA,SAAY,GAAA,IAAA,CAAA,CAAA;OAITC,EAAAA,SAAAA,CAAAA;EACT,CAAA;EAEA;;;;;;;;;;MAWO,SAASH,QAAAA,CAASlB,KAAK,EAAA;EAC5B,IAAA,IAAI,QAAiB,IAAjB,OAAOA,KAAAA,EACT,OAAOA,KAAAA,CAAAA;MAET,IAAqB,YAAjB,OAAOA,KAAAA,EACT,MAAM,KAAIwB,CAAM,oBAAC,GAAoBxB,KAAM,GAAA,IAAA,CAAA,CAAA;EAG7C,IAAA,IAAMkB,WAAWO,UAAWzB,CAAAA,KAAAA,CAAAA,CAAAA;EAC5B,IAAA,IAAI0B,MAAMR,QACR,CAAA,EAAA,MAAM,KAAU,CAAC,6BAA0BlB,KAAM,GAAA,IAAA,CAAA,CAAA;EAGnD,IAAA,OAAIA,MAAM2B,QAAQ,CAAC,IACVT,CAAAA,GAAAA,QAAAA,GAELlB,MAAM2B,QAAQ,CAAC,GACVT,CAAAA,GAAW,OAAXA,QAELlB,GAAAA,KAAAA,CAAM2B,QAAQ,CAAC,OACVT,KAAAA,GAAAA,QAAAA,GAAAA,KAAAA,CAAAA,CAAAA;EAEX;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MC7FC,IAMC,iBAAAU,gCAAA,CAAA,MAAA,CAAA,EAAA,aAAA,iBAAAA,gCAAA,CAAA,eAAA,CAAA,EA+BEC,gBAAAA,GAAAA,MAAAA,CAAOC,QAAQ,CAAA;EAvCZ,IAAA,YAAMC,GA+CZ,WA/CM;EAAMA,IAAAA,SAAAA,YAAAA,GAAAA;UAQX,MAAA,CAAA,cAAA,CAAA,IAAA,EAAA,aAAA,EAAA;EAAA,YAAA,KAAA,EAAA,YAAA;cAND,MAAA,CAAA,cAAA,CAAA,IAAA,EAAA,IAAA,EAAA;;qBAAA,KAAA,CAAA;EAGE,SAAA,CAAA,EAAAC,iCAAA,CAAA,IAAI,EAAEC,IAAAA,CAAAA,CAAAA,IAAAA,CAAAA,GAAM,IAAIC,GAAAA,EAAAA,CAAAA;;EALNH,IAAAA,IAAAA,MAAAA,GAAAA,YAAAA,CAAAA,SAAAA,CAAAA;EAaXI,IAAAA,OAAAA,MAAAA,CAAAA,GAGC,GAHDA,SAAI1C,EAAE,EAAE2C,GAAG,EAAA;iBACV,CAAK,CAAAJ,iCAAA,CAAA,IAAI,EAAEC,IAAAA,CAAAA,CAAAA,MAAIE,GAAG,CAAC1C,EACX,CAAA,IAAAuC,iCAAA,CAAA,IAAI,EAAEC,MAAAA,IAAII,CAAAA,CAAAA,GAAG,CAAC5C,EAAI0C,CAAAA,CAAAA,GAAG,CAACH,iCAAA,CAAA,IAAI,EAAEM,aAAAA,CAAAA,CAAAA,aAAaF,CAAAA,CAAAA,GAAAA,CAAAA,CAAAA,CAAAA;EAClD,KAAA,EAEAC,OAAAA,GAGC,GAHDA,SAAI5C,EAAE,EAAE2C,GAAG,EAAA;iBACVJ,iCAAK,CAAA,IAAI,EAAEC,IAAAA,CAAAA,CAAAA,MAAIE,GAAG,CAAC1C,EACX,CAAA,GAAAuC,iCAAA,CAAA,IAAI,EAAEC,MAAAA,IAAII,CAAAA,CAAAA,GAAG,CAAC5C,EAAAA,CAAAA,CAAI4C,GAAG,CAACL,kCAAA,IAAI,EAAEM,aAAAA,CAAAA,CAAAA,aAAAA,CAAAA,CAAaF,GADlB,CAAA,CAAA,GAAA,IAAA,CAAA;OAIhCG,EAAAA,MAAAA,CAAAA,GAKC,GALDA,SAAI9C,EAAE,EAAE2C,GAAG,EAAEpC,KAAK,EAAA;EACjB,QAAA,IAAMwC,YAAYR,iCAAA,CAAA,IAAI,EAAEC,IAAAA,CAAAA,CAAAA,MAAII,GAAG,CAAC5C,EAAO,CAAA,IAAA,IAAIyC,OACtCO,aAAgB,GAAAT,iCAAA,CAAA,IAAI,EAAEM,eAAAA,aAAaF,CAAAA,CAAAA,GAAAA,CAAAA,CAAAA;UACvCI,SAAUD,CAAAA,GAAG,CAACE,aAAAA,EAAezC,KAC7B,CAAA,EAAAgC,iCAAA,CAAA,IAAI,EAAEC,IAAAA,CAAAA,CAAAA,IAAAA,CAAAA,CAAIM,GAAG,CAAC9C,EAAI+C,EAAAA,SAAAA,CAAAA,CAAAA;EACpB,KAAA,EAEAE,OAAAA,MAGC,GAHDA,SAAOjD,EAAE,EAAE2C,GAAG,EAAA;iBACbJ,iCAAK,CAAA,IAAI,EAAEC,IAAAA,CAAAA,CAAAA,MAAIE,GAAG,CAAC1C,EACX,CAAA,GAAAuC,iCAAA,CAAA,IAAI,EAAEC,MAAAA,IAAII,CAAAA,CAAAA,GAAG,CAAC5C,EAAAA,CAAAA,CAAIiD,MAAM,CAACV,kCAAA,IAAI,EAAEM,aAAAA,CAAAA,CAAAA,aAAAA,CAAAA,CAAaF,GADrB,CAAA,CAAA,GAAA,IAAA,CAAA;OAIhCd,EAAAA,MAAAA,CAAAA,KAEC,GAFDA,WAAAA;EACE,QAAAU,iCAAA,CAAA,IAAI,EAAEC,IAAAA,CAAAA,CAAAA,IAAAA,CAAAA,GAAM,IAAIC,GAAAA,EAAAA,CAAAA;EAClB,KAAA,EAEA,MAAC,CAACL,gBAAgB,CAMjB,GAND,WAAA;EACapC,QAAAA,IAAAA,SAAAA,EAAAA,KAAAA,EAAAA,WAAAA,EAAAA,EAAAA,EAAAA,UAAAA,EAAAA,MAAAA,EAAAA,YAAAA,CAAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;yEAAkBuC,iCAAA,CAAA,IAAI,EAAEC,IAAAA,CAAAA,CAAAA,IAAAA,CAAAA,CAAAA,EAAAA,MAAAA,CAAAA,KAAAA,GAAAA,CAAAA,CAAAA;;;;;;EAAxBxC,oBAAAA,EAAAA,GAAAA,CAAAA,WAAAA,GAAAA,KAAAA,CAAAA,KAAAA,EAAAA,CAAAA,CAAAA,EAAAA,UAAAA,GAAAA,sCAAAA,CAAAA,WAAAA,CAAAA,CAAAA,CAAAA,CAAAA,EAAAA,MAAAA,CAAAA,KAAAA,GAAAA,CAAAA,CAAAA;;;;;;EAER,oBAAA,OAAA;;;EAAOA,4BAAAA,EAAAA;;;;;;EAAP,oBAAA,MAAA,CAAA,IAAA,EAAA,EAAA,MAAA,CAAA,KAAA,GAAA,CAAA,CAAA;;;;;;;;;;;;;;;;;OA1CMsC,EAAAA,YAAAA,CAAAA;EA+CZ,CAAA,EAAA,CAAA;EAvCC,SAAA,aAAcK,GAAG,EAAA;MAChB,OAAOO,IAAAA,CAAKC,SAAS,CAACR,GAAAA,CAAAA,CAAAA;EACrB;EACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ECRF,IAAMS,eAeL,WAfD;eAAMA,YAEQC,CAAAA,SAAS,EAAEC,OAAO,EAAA;EAC5B,QAAA,IAAI,CAACD,SAAS,GAAGA,WACjB,IAAI,CAACC,OAAO,GAAGA,OAAAA,CAAAA;;EAJbF,IAAAA,IAAAA,MAAAA,GAAAA,YAAAA,CAAAA,SAAAA,CAAAA;aAOJG,MAAAA,CAAAA,WAEC,GAFDA,SAAYvD,EAAE,EAAA;UACZA,EAAGwD,CAAAA,gBAAgB,CAAC,IAAI,CAACH,SAAS,EAAE,IAAI,CAACC,OAAO,CAAA,CAAA;EAClD,KAAA,EAEAG,MAAAA,CAAAA,cAEC,GAFDA,SAAezD,EAAE,EAAA;UACfA,EAAG0D,CAAAA,mBAAmB,CAAC,IAAI,CAACL,SAAS,EAAE,IAAI,CAACC,OAAO,CAAA,CAAA;OAZjDF,EAAAA,YAAAA,CAAAA;;EAiBN;;EAEC,IACM,IAAA,gBAAMO,GAgPZ,WAhPM;eAAMA,gBAQCC,CAAAA,IAAI,EAAEC,MAAM,EAAA;UACtB,IAHFd,IAAAA,CAAAA,SAAAA,GAAY,IAAIT,YAAAA,EAAAA,EAGV,CAAMwB,cAAJF,IAAgBvE,EAAAA,aAAAA,CAAAA,EACpB,MAAU0C,KAAM,CAAA,mFAAA,CAAA,CAAA;UAGlB,IAAI,CAAC6B,IAAI,GAAGA,IACZ,EAAA,IAAI,CAACrE,OAAO,GAAG,IAAI,CAACqE,IAAI,CAACrE,OAAO,CAACE,WAAW,EAC5C,EAAA,IAAI,CAACoE,MAAM,GAAG,IAAI,CAACE,aAAa,CAACF,MAAAA,CAAAA;EAIjC,QAAA,IAAI,CAACD,IAAI,CAACI,aAAa,CAAC,IAAI,CAAA,CAAA;;EAnBnBL,IAAAA,IAAAA,MAAAA,GAAAA,gBAAAA,CAAAA,SAAAA,CAAAA;aAsBXI,MAAAA,CAAAA,aAqBC,GArBDA,SAAcF,MAAM,EAAA;UAGlB,IAFII,IAAAA,KAAAA,EAAAA,cAAAA,GAAiB,IAAIxB,GAAAA,EAAAA,EAAAA,SAAAA,GAAAA,sCAAAA,CAELoB,MAAQ,CAAA,EAAA,CAAA,CAAA,KAAA,GAAA,SAAA,EAAA,EAAA,IAAA,EAAA;EAAjBK,YAAAA,IAAAA,KAAAA,GAAAA,KAAAA,CAAAA,KAAAA,EACLC,SAAAA,KAAAA,CAAAA,CAAAA;EACJ,YAAA,IAAIL,aAAa,CAAZI,MAAMC,MAAM,EAAYC,gBAAiBF,aAAY,CAAZA,MAAMC,MAAM,EAAYE,aAAcH,aAAY,CAAZA,MAAMC,MAAM,EAAYG,SAC1GH,MAAS,GAAA;kBAACI,IAAM,EAAA,SAAA;EAAWC,gBAAAA,OAAAA,EAASN,MAAMC,MAAM;EAAA,aAAA,CAAA;EAEhD,iBAAA,IAAI,QAAA,IAAA,OAAOD,KAAMC,CAAAA,MAAM,EACrBA,MAAS,GAAA;kBAACI,IAAM,EAAA,QAAA;EAAUJ,gBAAAA,MAAAA,EAAQD,MAAMC,MAAM;EAAElE,gBAAAA,QAAAA,EAAUiE,MAAMjE,QAAQ;EAAA,aAAA,CAAA;EAExE,iBAAA,MAAM,KAAU,CAAC,6DAA0DiD,IAAKC,CAAAA,SAAS,CAACe,KAAO,CAAA,GAAA,GAAA,CAAA,CAAA;cAIrGD,cAAenB,CAAAA,GAAG,CAACqB,MAAQD,EAAAA,KAAAA,CAAAA,CAAAA;EAC7B,SAAA;;UAIA,OAAOD,cAAAA,CAAAA;OAGTQ,EAAAA,MAAAA,CAAAA,aAWC,GAXDA,WAAAA;;;UAIE,IAAI,CAACC,kBAAkB,EAAA;EAGvB,QAAA,IAAI,CAACC,kBAAkB,CAAC,IAAI,CAACf,IAAI;UAGjC,IAAI,CAACgB,MAAM,CAAC;cAAC,IAAI,CAAChB,IAAI,CAAChD,UAAU;EAAE,YAAA,IAAI,CAACgD,IAAI;EAAC,SAAA,CAAA,CAAA;OAG/CiB,EAAAA,MAAAA,CAAAA,gBAYC,GAZDA,WAAAA;;;UAIE,cAAA,GAAA,IAAI,CAACC,QAAQ,CAAb,IAAA,cAAA,CAAeC,UAAU,EACzB,EAAA,IAAI,CAACD,QAAQ,GAAG,IAAA,CAAA;;EAGhB,QAAA,IAAA,IAJA,cAIyC,EAAA,KAAA,EAAA,SAAA,GAAAtE,sCAAA,CAAA,IAAI,CAACuC,SAAS,CAAE,EAAA,CAAA,CAAA,KAAA,GAAA,SAAA,EAAA,EAAA,IAAA,EAAA;EAA7CyB,YAAAA,IAAAA,WAAAA,GAAAA,KAAAA,CAAAA,KAAAA,EAAAA,OAAAA,GAAAA,WAAAA,CAAAA,CAAAA,CAAAA,CAAAA;EACVlB,YAAAA,CAAAA,WAAAA,CAAAA,CAAAA,CAAAA,EAAAA,WAAAA,CAAAA,CAAAA,CAAAA,EAAQG,cAAc,CAACe,OAAAA,CAAAA,CAAAA;EACzB,SAAA;UACA,IAAI,CAACzB,SAAS,CAAClB,KAAK,EAAA,CAAA;EACtB,KAAA,EAEAmD,MAAAA,CAAAA,aAwDC,GAxDDA,SAAcd,KAAK,EAAA;4BAEbb,SAAYa,GAAAA,KAAAA,CAAMA,KAAK,EAGvBZ,OAAU,GAAA,WAAA;+CAAIhC,IAAAA,GAAAA,KAAAA,CAAAA,IAAAA,CAAAA,EAAAA,IAAAA,GAAAA,CAAAA,EAAAA,IAAAA,GAAAA,IAAAA,EAAAA,IAAAA,EAAAA,CAAAA,IAAAA,CAAAA,IAAAA,CAAAA,GAAAA,SAAAA,CAAAA,IAAAA,CAAAA,CAAAA;EAAS4C,YAAAA,OAAAA,KAAAA,CAAMZ,OAAO,CAAC9B,KAAK,CAAC,KAAA,CAAKoC,IAAI,EAAEtC,IAAAA,CAAAA,CAAAA;;;UAyB1D,IAtBI4C,KAAAA,CAAMxC,QAAQ,GAChB4B,OAAU5B,GAAAA,QAAAA,CAAS4B,SAASY,KAAMxC,CAAAA,QAAQ,CACjCwC,GAAAA,KAAAA,CAAMhD,QAAQ,KACvBoC,OAAUpC,GAAAA,QAAAA,CAASoC,OAASY,EAAAA,KAAAA,CAAMhD,QAAQ,CAAA,GAEpB,IAApBgD,IAAAA,KAAAA,CAAM,OAAU,IAAY,KAA4B,MAArBA,KAAM,CAAA,OAAU,KACrDZ,OAAUY,GAAAA,KAAAA,CAAMe,OAAO,CAACC,IAAI,CAAC,IAAI,CAACtB,IAAI,EAAEN,OAAO,kBAAe,CAAA,EAInC,QAAzB,IAAA,OAAOY,KAAMjE,CAAAA,QAAQ,KAEfkF,WAAAA,GAAc7B,OADtBA,EAAAA,OAAAA,GAES,SAAC8B,CAAAA,EAAAA;EACFA,YAAAA,CAAAA,CAAEjB,MAAM,CAACjE,OAAO,CAACgE,KAAMjE,CAAAA,QAAQ,KACjCkF,WAAYC,CAAAA,CAAAA,CAAAA,CAAAA;WAOhB,CAAA,EAAoB,QAApB,IAAA,OAAO/B,SAAuB,EAAA;cAChC,IAXQ8B,WAAAA,EAqBAE,OACAF,EAAAA,YAAAA,EAXFG,MAASjC,GAAAA,SAAAA,CAAAA;EACf,YAAA,IAAI,IAAqB,IAApBiC,MAAOjC,CAAAA,SAAS,IAAc,UAA0B,IAA1B,OAAOiC,MAAAA,CAAOD,OAAO,EACtD,MAAM,KAAItD,CAAM,2DAA4DuD,GAAAA,MAAAA,CAAAA,CAAAA;;cAI9EjC,SAAYiC,GAAAA,MAAAA,CAAOjC,SAAS,EAIpBgC,OAAAA,GAAUC,OAAOD,OAAO,EACxBF,YAAc7B,GAAAA,OAAAA;EAFtBA,YAAAA,OAAAA,GAGS,SAAC8B,CAAAA,EAAAA;EACFC,gBAAAA,OAAAA,CAAQD,MACVD,YAAYC,CAAAA,CAAAA,CAAAA,CAAAA;EAEhB,aAAA,CAAA;EAGJ,SAAA;UAKA,OAFqB,IAAIhC,aAAaC,SAAWC,EAAAA,OAAAA,CAAAA,CAAAA;OAKnDoB,EAAAA,MAAAA,CAAAA,kBAgBC,GAhBDA,WAAAA;UACE,IAAiC,IAAA,KAAA,EAAA,SAAA,GAAAlE,sCAAA,CAAA,IAAI,CAACqD,MAAM,CAAE,EAAA,CAAA,CAAA,KAAA,GAAA,SAAA,EAAA,EAAA,IAAA,EAAA;6CAAlC0B,SAAWrB,GAAAA,WAAAA,CAAAA,CAAAA,CAAAA,EAAAA,KAAAA,GAAAA,WAAAA,CAAAA,CAAAA,CAAAA,CAAAA;cACrB,IAAuB,SAAnBqB,KAAAA,SAAAA,CAAUhB,IAAI,EAAA;EAElB,gBAAA,IAAM5B,GAAM,GAAA;EAAC6B,oBAAAA,OAAAA,EAASe,UAAUf,OAAO;sBAAEL,MAAQoB,EAAAA,SAAAA;EAAS,iBAAA,CAAA;kBAC1D,IAAI,CAAA,IAAI,CAACxC,SAAS,CAACL,GAAG,CAAC6C,SAAAA,CAAUf,OAAO,EAAE7B,GAAAA,CAAAA,EAAAA;;EAG1C,oBAAA,IAAM6C,YAAe,GAAA,IAAI,CAACR,aAAa,CAACd,KAAAA,CAAAA,CAAAA;;EAGxCsB,oBAAAA,YAAAA,CAAajC,WAAW,CAACgC,SAAUf,CAAAA,OAAO;sBAG1C,IAAI,CAACzB,SAAS,CAACD,GAAG,CAACyC,SAAUf,CAAAA,OAAO,EAAE7B,GAAK6C,EAAAA,YAAAA,CAAAA,CAAAA;;;EAC7C,SAAA;EACF,KAAA,EAEAC,OAAAA,UAyCC,GAzCDA,SAAWzF,EAAE,EAAE0F,YAAY,EAAA;;;UAIzB,IAAiC,IAAA,KAAA,EAAA,SAAA,GAAAlF,sCAAA,CAAA,IAAI,CAACqD,MAAM,CAAE,EAAA,CAAA,CAAA,KAAA,GAAA,SAAA,EAAA,EAAA,IAAA,EAAA;6CAAlC0B,SAAWrB,GAAAA,WAAAA,CAAAA,CAAAA,CAAAA,EAAAA,KAAAA,GAAAA,WAAAA,CAAAA,CAAAA,CAAAA,CAAAA;cACrB,IAAuB,QAAnBqB,KAAAA,SAAAA,CAAUhB,IAAI,EAAA;kBAElB,IAAMc,OAAAA,GAAU,IAAI,CAACzB,IAAI,CAAC7D,aAAa,CAACC,IAAI,IAAI,CAACT,OAAO,EAAEgG,SAAAA,CAAUpB,MAAM,CAAK,IAAA,IAAI,CAACP,IAAI,CAACzD,cAAc,CAACH,EAAI,EAAA,IAAI,CAACT,OAAO,EAAEgG,UAAUpB,MAAM,CAAA,EACpIwB,aAAa,CAACN,OAAAA,IAAYK,gBAAgB,IAAI,CAAC9B,IAAI,CAACtE,gBAAgB,CAAC,IAAI,CAACC,OAAO,EAAEgG,SAAAA,CAAUpB,MAAM,CAAA,EACnGxB,GAAM,GAAA;sBAAC6B,OAASxE,EAAAA,EAAAA;EAAI4F,oBAAAA,EAAAA,EAAI1B,MAAM0B,EAAE;EAAA,iBAAA,CAAA;EAEtC,gBAAA,IAAIP,OAAS,EAAA;sBACX,IAAI,IAAI,CAACtC,SAAS,CAACL,GAAG,CAAC1C,EAAI2C,EAAAA,GAAAA,CAAAA,IAMvBkD,EADiB7F,CAAG8F,WAAW,EAAA,KAAO,IAAI,CAAClC,IAAI,CAAChD,UAAU,IAC1CZ,EAAAA,CAAGU,OAAO,CAAC,IAAI,CAACnB,OAAO,CANV,EAAA,SAAA;;EASjC,oBAAA,IAAMiG,YAAe,GAAA,IAAI,CAACR,aAAa,CAACd,KAAAA,CAAAA,CAAAA;;sBAGxCsB,YAAajC,CAAAA,WAAW,CAACvD,EAAAA,CAAAA;EAGzB,oBAAA,IAAI,CAAC+C,SAAS,CAACD,GAAG,CAAC9C,IAAI2C,GAAK6C,EAAAA,YAAAA,CAAAA,CAAAA;EAC9B,iBAAA,MAAO,IAAIG,UAAY,EAAA;sBACrB,IAAI,CAAC,IAAI,CAAC5C,SAAS,CAACL,GAAG,CAAC1C,IAAI2C,GAAM,CAAA,EAAA,SAAA;;;EAKlC,oBAAA,IAAMW,UAAU,IAAI,CAACP,SAAS,CAACH,GAAG,CAAC5C,EAAI2C,EAAAA,GAAAA,CAAAA,CAAAA;EACvCW,oBAAAA,IAAAA,IAAAA,OAAAA,IAAAA,OAASG,CAAAA,cAAc,CAACzD,EAAAA,CAAAA;EAGxB,oBAAA,IAAI,CAAC+C,SAAS,CAACE,MAAM,CAACjD,EAAI2C,EAAAA,GAAAA,CAAAA,CAAAA;EAC5B,iBAAA;;EACF,SAAA;EACF,KAAA,EAEAgC,MAAAA,CAAAA,kBAUC,GAVDA,SAAmBoB,IAAI,EAAA;;EAErB,QAAA,IAAA,IAAA,KAAA,EAAA,SAAA,GAAAvF,sCAAA,CAAiBuF,KAAKtF,gBAAgB,CAAC,GAAI,GAAA,IAAI,CAACmD,IAAI,CAAChE,eAAe,GAAC,QAAK,IAAI,CAACgE,IAAI,CAAC9D,gBAAgB,GAAC,GAAK,CAAA,CAAA,EAAA,CAAA,CAAA,KAAA,GAAA,SAAA,EAAA,EAAA,IAAA,EAAA;EAA/FE,YAAAA,IAAAA,EAAAA,GAAAA,KAAAA,CAAAA,KAAAA,CAAAA;cACT,IAAI,CAACyF,UAAU,CAACzF,EAAAA,CAAAA,CAAAA;EAClB,SAAA;UAGQ8D,aAAJiC,CAAAA,IAAAA,EAAgBC,OAAYD,CAAAA,KAAAA,IAAKE,CAAAA,YAAY,CAAC,IAAI,CAACrC,IAAI,CAAChE,eAAe,CAAA,IAAKmG,KAAKE,YAAY,CAAC,IAAI,CAACrC,IAAI,CAAC9D,gBAAgB,CAAA,CAC1H,IAAA,IAAI,CAAC2F,UAAU,CAACM,IAAAA,CAAAA,CAAAA;EAEpB,KAAA,EAEAnB,MAAAA,CAAAA,MAmCC,GAnCDA,SAAOsB,GAAG,EAAA;;UACH,IAAI,CAACpB,QAAQ;EAEhB,SAAA,IAAI,CAACA,QAAQ,GAAG,IAAIqB,iBAAiBC,SAAAA,SAAAA,EAAAA;EACnC,YAAA,IAAA,IAAA,KAAA,EAAA,SAAA,GAAA5F,sCAAA,CAAuB4F,SAAW,CAAA,EAAA,CAAA,CAAA,KAAA,GAAA,SAAA,EAAA,EAAA,IAAA,EAAA;EAAvBC,gBAAAA,IAAAA,QAAAA,GAAAA,KAAAA,CAAAA,KAAAA,CAAAA;EACT,gBAAA,IAAIA,YAAAA,KAAAA,QAAAA,CAAS9B,IAAI,IAAoCT,cAAfuC,QAASlC,CAAAA,MAAM,EAAY6B,OAAAA,CAAAA,EAC/D,MAAKP,UAAU,CAACY,SAASlC,MAAM,EAAEkC,SAASC,QAAQ,CAAA,CAAA;EAC7C,qBAAA,IAAID,WAAkB,KAAlBA,QAAS9B,CAAAA,IAAI,IAAoB8B,QAAAA,CAASE,UAAU,CAACC,MAAM,EACpE,IAAmBH,IAAAA,MAAAA,EAAAA,UAAAA,GAAAA,sCAAAA,CAAAA,QAAAA,CAASE,UAAU,CAAE,EAAA,CAAA,CAAA,MAAA,GAAA,UAAA,EAAA,EAAA,IAAA,EAAA;EAA7BE,oBAAAA,IAAAA,IAAAA,GAAAA,MAAAA,CAAAA,KAAAA,CAAAA;EACD,oBAAA3C,aAAA,CAAJ2C,IAAgBT,EAAAA,OAAAA,CAAAA,IAClB,KAAKrB,CAAAA,kBAAkB,CAAC8B,IAAAA,CAAAA,CAAAA;EAE5B,iBAAA;EAEJ,aAAA;WACD,CAAA,CAAA,CAAA;;EAIH,QAAA,IAAA,IAAA,KAAA,EAAA,SAAA,GAAAjG,sCAAA,CAAiB0F,GAAK,CAAA,EAAA,CAAA,CAAA,KAAA,GAAA,SAAA,EAAA,EAAA,IAAA,EAAA;EAAXlG,YAAAA,IAAAA,EAAAA,GAAAA,KAAAA,CAAAA,KAAAA,CAAAA;EACC,YAAA,IAAA,IAANA,MAEJ,IAAI,CAAC8E,QAAQ,CAAC4B,OAAO,CACnB1G,EACA,EAAA;EACE2G,gBAAAA,SAAAA,EAAW,CAAA,CAAA;EACXC,gBAAAA,OAAAA,EAAS,CAAA,CAAA;kBACTC,eAAiB,EAAA;sBACf,IAAI,CAACjD,IAAI,CAAChE,eAAe;sBACzB,IAAI,CAACgE,IAAI,CAAC9D,gBAAgB;EAC3B,iBAAA;EACDgH,gBAAAA,iBAAAA,EAAoB,CAAA,CAAA;EACtB,aAAA,CAAA,CAAA;EAEJ,SAAA;OA7OSnD,EAAAA,gBAAAA,CAAAA;EAgPZ,CAAA,EAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ECvQD,IAAMoD,yBAuFL,WAvFD;EAAMA,IAAAA,SAAAA,sBAAAA,CAUQC,QAAQ,EAAA;;UAClB,IAAI,CAACA,QAAQ,GAAGA,QAAAA,EAChB,IAAI,CAACjE,SAAS,GAAG,IAAIkE,GACrB,EAAA,EAAA,IAAI,CAACC,SAAS,GAAG,CAAA,CAEjB,EAAA,IAAI,CAACpC,QAAQ,GAAG,IAAIqB,gBAAAA,CAAiBC,SAAAA,SAAAA,EAAAA;EACnC,YAAA,IAAA,IAAA,KAAA,EAAA,SAAA,GAAA5F,sCAAA,CAAuB4F,SAAW,CAAA,EAAA,CAAA,CAAA,KAAA,GAAA,SAAA,EAAA,EAAA,IAAA,EAAA;EAAvBC,gBAAAA,IAAAA,QAAAA,GAAAA,KAAAA,CAAAA,KAAAA,CAAAA;EACT,gBAAA,IAAIA,WAAAA,KAAAA,QAAAA,CAAS9B,IAAI,KAAqB8B,QAASE,CAAAA,UAAU,CAACC,MAAM,IAAIH,QAASc,CAAAA,YAAY,CAACX,MAAM,CAAG,EAAA;;;sBAIjG,IAAmBH,IAAAA,MAAAA,EAAAA,UAAAA,GAAAA,sCAAAA,CAAAA,QAAAA,CAASE,UAAU,CAAE,EAAA,CAAA,CAAA,MAAA,GAAA,UAAA,EAAA,EAAA,IAAA,EAAA;EAA7BE,wBAAAA,IAAAA,IAAAA,GAAAA,MAAAA,CAAAA,KAAAA,CAAAA;0BACT,IAAQ3C,aAAJ2C,CAAAA,IAAAA,EAAgBT,OAAS,CAAA,EAAA;EAC3B,4BAAA,IAAMzG,OAAUkH,GAAAA,IAAAA,CAAKlH,OAAO,CAACE,WAAW,EAAA,CAAA;EACpC,4BAAA,CAAA,OAAY,IAAXF,OAAwBA,IAAW,UAAXA,OAAqBkH,IAA4B,YAA5BA,IAAAA,IAAAA,CAAKW,YAAY,CAAC,KAAA,CAAsB,KACxF,KAAA,CAAKC,eAAe,CAAC;kCAAC9C,IAAM,EAAA,KAAA;kCAAOkC,IAAAA,EAAAA,IAAAA;EAAI,6BAAA,CAAA,CAAA;EAE3C,yBAAA;EACF,qBAAA;sBAEA,IAAmBJ,IAAAA,MAAAA,EAAAA,UAAAA,GAAAA,sCAAAA,CAAAA,QAAAA,CAASc,YAAY,CAAE,EAAA,CAAA,CAAA,MAAA,GAAA,UAAA,EAAA,EAAA,IAAA,EAAA;EAA/BV,wBAAAA,IAAAA,KAAAA,GAAAA,MAAAA,CAAAA,KAAAA,CAAAA;0BACT,IAAQ3C,aAAJ2C,CAAAA,KAAAA,EAAgBT,OAAS,CAAA,EAAA;EAC3B,4BAAA,IAAMzG,QAAUkH,GAAAA,KAAAA,CAAKlH,OAAO,CAACE,WAAW,EAAA,CAAA;EACpC,4BAAA,CAAA,OAAY,IAAXF,QAAwBA,IAAW,UAAXA,QAAqBkH,IAA4B,YAA5BA,IAAAA,KAAAA,CAAKW,YAAY,CAAC,KAAA,CAAsB,KACxF,KAAA,CAAKC,eAAe,CAAC;kCAAC9C,IAAM,EAAA,QAAA;kCAAUkC,IAAAA,EAAAA,KAAAA;EAAI,6BAAA,CAAA,CAAA;EAE9C,yBAAA;EACF,qBAAA;EAEF,iBAAA;EACF,aAAA;EACF,SAAA,CAAA,CAAA;;EAzCEM,IAAAA,IAAAA,MAAAA,GAAAA,sBAAAA,CAAAA,SAAAA,CAAAA;EA4CJL,IAAAA,OAAAA,MAAAA,CAAAA,OAYC,GAZDA,WAAAA;EACM,QAAA,IAAI,CAACQ,SAAS,KAElB,IAAI,CAACpC,QAAQ,CAAC4B,OAAO,CACnB,IAAI,CAACM,QAAQ,CAACM,IAAI,EAClB;EACEX,YAAAA,SAAAA,EAAW,CAAA,CAAA;EACXC,YAAAA,OAAAA,EAAS,CAAA,CAAA;EACX,SAAA,CAAA,EAGF,IAAI,CAACM,SAAS,GAAG,CAAA,CAAA,CAAA,CAAA;OAGnBnC,EAAAA,MAAAA,CAAAA,UAOC,GAPDA,WAAAA;EACO,QAAA,IAAI,CAACmC,SAAS,KAEnB,IAAI,CAACpC,QAAQ,CAACyC,WAAW,EAAA,EACzB,IAAI,CAACzC,QAAQ,CAACC,UAAU,EAAA,EAExB,IAAI,CAACmC,SAAS,GAAG,CAAA,CAAA,CAAA,CAAA;EACnB,KAAA,EAEA3D,MAAAA,CAAAA,WAKC,GALDA,SAAYpC,EAAE,EAAA;EACZ,QAAA,IAAI,CAAC4B,SAAS,CAACyE,GAAG,CAACrG,EACf,CAAA,EAAA,IAAI,CAAC4B,SAAS,CAAC0E,IAAI,GAAG,CACxB,IAAA,IAAI,CAACf,OAAO,EAAA,CAAA;EAEhB,KAAA,EAEAjD,MAAAA,CAAAA,cAKC,GALDA,SAAetC,EAAE,EAAA;EACf,QAAA,IAAI,CAAC4B,SAAS,CAACE,MAAM,CAAC9B,EACK,CAAA,EAAA,CAAA,IAAvB,IAAI,CAAC4B,SAAS,CAAC0E,IAAI,IACrB,IAAI,CAAC1C,UAAU,EAAA,CAAA;EAEnB,KAAA,EAEAsC,MAAAA,CAAAA,eAIC,GAJDA,SAAgBK,SAAS,EAAA;EACvB,QAAA,IAAA,IAAA,KAAA,EAAA,SAAA,GAAAlH,sCAAA,CAAuB,IAAI,CAACuC,SAAS,CAAA,EAAA,CAAA,CAAA,KAAA,GAAA,SAAA,EAAA,EAAA,IAAA,EACnC4E,IAASD,KAAAA,CAAAA,KAAAA,EAAAA,SAAAA,CAAAA,CAAAA;OAnFTX,EAAAA,sBAAAA,CAAAA;;EAyFN;;EAEC,IACM,IAAA,sBAAMa,GA0GZ,WA1GM;eAAMA,sBAWChE,CAAAA,IAAI,EAAEiE,YAAY,EAAA;;eAL9BC,WAAc,GAAA,CAAA,QAGdC,MAAS,GAAA,IAAIC,WAGPH,YACF,KAAA,IAAI,CAACjE,IAAI,GAAGA,IAAAA,EACZ,IAAI,CAACA,IAAI,CAACI,aAAa,CAAC,IAAI,GAC5B,IAAI,CAACiE,aAAa,GAAG,SAACC,CAAAA,EAAAA;EAAM,YAAA,OAAA,KAAA,CAAKC,OAAO,CAACD,CAAAA,CAAAA,CAAAA;;;EAflCN,IAAAA,IAAAA,MAAAA,GAAAA,sBAAAA,CAAAA,SAAAA,CAAAA;EAmBXnD,IAAAA,OAAAA,MAAAA,CAAAA,aAyBC,GAzBDA,WAAAA;EACE,QAAA,IAAM7D,aAAa,IAAwB,IAAxB,IAAI,CAACgD,IAAI,CAAChD,UAAU,CAAA;EAEvC,QAAA,IAAI,CAAC,IAAI,CAACkH,WAAW,EAAE;cACrB,IAAI,CAACA,WAAW,GAAG,CAAA,CAAA,CAAA;EAEnB,YAAA,IAAM/B,IAAO,GAAA,IAAI,CAACnC,IAAI,CAACwE,UAAU,EAC3BpB,QAAAA,GAAW,IAAI,CAACpD,IAAI,CAACyE,aAAa,CAAA;EAExC,YAAA,IAAIzH,UAAY,EAAA;;EAEd,gBAAA,IAAA,IAAA,KAAA,EAAA,SAAA,GAAAJ,sCAAA,CAAoBwG,QAASM,CAAAA,IAAI,CAAC7G,gBAAgB,CAAC,OAAU,CAAA,CAAA,EAAA,CAAA,CAAA,KAAA,GAAA,SAAA,EAAA,EAAA,IAAA,EAAA;EAAlD6H,oBAAAA,IAAAA,KAAAA,GAAAA,KAAAA,CAAAA,KAAAA,CAAAA;sBACT,IAAI,CAACC,QAAQ,CAACD,KAAOvC,EAAAA,IAAAA,CAAAA,CAAAA;EACvB,iBAAA;;EAGA,gBAAA,IAAA,IAAA,MAAA,EAAA,UAAA,GAAAvF,sCAAA,CAAoBwG,QAASM,CAAAA,IAAI,CAAC7G,gBAAgB,CAAC,wBAA2B,CAAA,CAAA,EAAA,CAAA,CAAA,MAAA,GAAA,UAAA,EAAA,EAAA,IAAA,EAAA;EAAnE6H,oBAAAA,IAAAA,MAAAA,GAAAA,MAAAA,CAAAA,KAAAA,CAAAA;sBACT,IAAI,CAACC,QAAQ,CAACD,MAAOvC,EAAAA,IAAAA,CAAAA,CAAAA;EACvB,iBAAA;EACF,aAAA;EACF,SAAA;UAEInF,UACF,IAAA,IAAI,CAAC4H,cAAc,EAAA,CAAA;EAEvB,KAAA,EAEAD,OAAAA,QAkBC,GAlBDA,SAASD,KAAK,EAAEvC,IAAW,EAAA;;UAEzB,IAFcA,KAAAA,CAAAA,KAAAA,IAAAA,KAAAA,IAAO,GAAA,IAAG,GAEpBuC,OAAqC,IAArCA,KAAMlB,CAAAA,YAAY,CAAC,aAAA,CAAA,EAAA;EAEX,YAAA,IAAA,IAARrB,SAAcA,IAAAA,GAAO,IAAI,CAACnC,IAAI,CAACwE,UAAU,CAAD,EAGtB,QAAlB,IAAI,CAACK,SAAS,KAChB,IAAI,CAACA,SAAS,GAAG,IAAI,CAAC7E,IAAI,CAACyE,aAAa,CAACK,aAAa,CAAC,iBAAA,CAAA,EACvD3C,IAAK4C,CAAAA,YAAY,CAAC,IAAI,CAACF,SAAS,EAAE1C,KAAK6C,UAAU,CAAA,CAAA,CAAA;;EAInD,YAAA,IAAMC,UAAaP,GAAAA,KAAAA,CAAMQ,SAAS,CAAC,CAAA,CAAA,CAAA,CAAA;EACnC,YAAA,IAAI,CAACL,SAAS,CAACM,WAAW,CAACF;EAG3B,YAAA,IAAI,CAACd,MAAM,CAACjF,GAAG,CAACwF,KAAOO,EAAAA,UAAAA,CAAAA,CAAAA;;EACzB,KAAA,EAEAG,MAAAA,CAAAA,WAMC,GANDA,SAAYV,KAAK,EAAA;EACf,QAAA,IAAMO,aAAa,IAAI,CAACd,MAAM,CAACnF,GAAG,CAAC0F,KAAAA,CAAAA,CAAAA;UACjB,IAAdO,IAAAA,UAAAA,KACFA,WAAWI,MAAM,EAAA,EACjB,IAAI,CAAClB,MAAM,CAAC9E,MAAM,CAACqF,KAAAA,CAAAA,CAAAA,CAAAA;OAIvBzD,EAAAA,MAAAA,CAAAA,gBAEC,GAFDA,WAAAA;EACE,QAAA,IAAI,CAACqE,aAAa,EAAA,CAAA;OAGpBV,EAAAA,MAAAA,CAAAA,cAQC,GARDA,WAAAA;EAEyC,QAAA,IAAA,IAAnCZ,sBAAuB9C,CAAAA,QAAQ,KAhF1B8C,uBAiFgB9C,QAAQ,GAAG,IAAIiC,sBAAAA,CAAuB,IAAI,CAACnD,IAAI,CAACyE,aAAa,CAAA;EAjF7ET,QAAAA,sBAAAA,CAqFc9C,QAAQ,CAACvB,WAAW,CAAC,IAAI,CAAC0E,aAAa,CAAA,CAAA;OAGhEiB,EAAAA,MAAAA,CAAAA,aAIC,GAJDA,WAAAA;EACyC,QAAA,IAAA,IAAnCtB,sBAzFKA,CAyFkB9C,QAAQ,IACjC8C,sBA1FOA,CA0FgB9C,QAAQ,CAACrB,cAAc,CAAC,IAAI,CAACwE,aAAa,CAAA,CAAA;EAErE,KAAA,EAEAE,MAAAA,CAAAA,OAUC,GAVDA,SAAQ,KAAY,EAAA;EAAZ,QAAA,IAAC5D,IAAD,GAAA,KAAA,CAACA,IAAMkC,EAAAA,IAAAA,GAAP,KAAOA,CAAAA,IAAAA,CAAAA;UACb,OAAOlC,IAAAA;cACL,KAAK,KAAA;kBACH,IAAI,CAACgE,QAAQ,CAAC9B,IAAAA,CAAAA,CAAAA;EACd,gBAAA,MAAA;cAEF,KAAK,QAAA;kBACH,IAAI,CAACuC,WAAW,CAACvC,IAAAA,CAAAA,CAAAA;EAErB,SAAA;OAvGSmB,EAAAA,sBAAAA,CAAAA;EA0GZ,CAAA,EAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ECxHC;EAEA,OAAA,iBAAA,8BAAA,CAAA,SAAA,CAAA,EAEA,cA2CA,iBAAA,8BAAA,CAAA,gBAAA,CAAA,EAAA,uBAAA,iBAAA,8BAAA,CAAA,yBAAA,CAAA,CAAA;EAxHF;;;;;;;;;;;;;;;EAeC,IACM,IAAA,SAAMuB,GAiLZ,SAjLM,aAAA,EAAA;EAAMA,IAAAA,SAAAA,SAAAA,GAAAA;;uEA6DX,MAAA,CAAA,cAAA,CAAA,wBAAA,CAAA,KAAA,CAAA,EAAA,cAAA,EAAA;EAAA,YAAA,KAAA,EAAA,aAAA;cAFA,MAAA,CAAA,cAAA,CAAA,wBAAA,CAAA,KAAA,CAAA,EAAA,OAAA,EAAA;;qBAAA,KAAA,CAAA;cA6CA,MAAA,CAAA,cAAA,CAAA,wBAAA,CAAA,KAAA,CAAA,EAAA,uBAAA,EAAA;;qBAAA,KAAA,CAAA;EAACC,SAAAA,CAAAA,EAAAA,+BAAAA,CAAAA,KAAAA,EAAAA,uBAAAA,CAAAA,CAAAA,uBAAyB,CAAA,GAAA,IAAIxB,sBAA6B,CAAA,wBAAA,CAAA,KAAA,CAAA,EAAA,KAAA,CAAKC,YAAY,CAAA,EAAA,KAAA,CAAA;;;;;;;;;;;EAxGjEsB,KAAAA,CAAAA,SAAAA,EAAAA,aAAAA,CAAAA,CAAAA;EAAAA,IAAAA,IAAAA,UAAAA,CAAAA,CAAAA,MAAAA,GAAAA,SAAAA,CAAAA,UAAAA;;;EA2BX;;QAGAE,MAAAA,CAAAA,MAEC,GAFDA,WAAAA;UACE,OAAOC,QAAAA,CAAAA,eAAAA,EAAAA,CAAAA,CAAAA;OAgGTC,EAAAA,MAAAA,CAAAA,gBAyBC,GAzBDA,WAAAA;EAEE,QAAA,IADIxD,MACExG,OAAU,GAAA,IAAI,CAACA,OAAO,CAACE,WAAW,EAAA,CAAA;UAExC,IAAI,IAAI,CAAC+J,QAAQ,EAAE;;EAEjB,YAAA,IAAIC,cAAc,IAAI,CAACC,aAAa,CAAE,iBAAcnK,OAAQ,GAAA,IAAA,CAAA,CAAA;cAIzC,IAAfkK,IAAAA,WAAAA,IAAuBA,WAAY/I,CAAAA,OAAO,CAACnB,OAAAA,CAAAA,IAAY,IAAI,KAC7DkK,WAAAA,GAAc,IAAG,CAAA;cAInB1D,IAAO0D,GAAAA,IAAAA,IAAAA,WAAAA,GAAAA,WAAAA,GAAe,IAAI,CAAA;WAE1B1D,MAAAA,IAAAA,GAAO,wBAAMwD,gBAAD,CAAA,IAAA,CAAA,IAAA,CAAA,CAAA;EAOd,QAAA,OAJI,IAAI,CAACC,QAAQ,IAA0B,CAAA,CAAtB,KAAA,IAAI,CAAC3B,YAAY,IACpC8B,OAAQC,CAAAA,IAAI,CAAC,cAAC,GAAcrK,UAAQ,sEAG/BwG,CAAAA,EAAAA,IAAAA,CAAAA;EACT,KAAA;;EAMA8D,IAAAA,MAAAA,CAAAA,iBAOC,GAPDA,WAAAA;UACO,+BAAA,CAAA,IAAI,EAAEhG,OAAAA,CAAAA,CAAAA,OAAAA,CAAAA,KACT,gCAAA,IAAI,EAAEE,cAAAA,CAAAA,CAAAA,cAAAA,CAAAA,EAAAA,EACN,+BAAA,CAAA,IAAI,EAAEF,OAAAA,CAAAA,CAAAA,OAAAA,CAAAA,GAAS,IAAIF,gBAAAA,CAAiB,IAAI,EAAE,IAAI,CAACE,MAAM,CAGvD,CAAA,EAAA,aAAA,CAAA,SAAA,CAAMgG,iBAAD,CAAA,IAAA,CAAA,IAAA,CAAA,CAAA;OAGPC,EAAAA,MAAAA,CAAAA,oBAMC,GANDA,WAAAA;EACE,QAAA,aAAA,CAAA,SAAA,CAAMA,oBAAD,CAAA,IAAA,CAAA,IAAA,CAAA,EAE0B,KAAA,CAAA,KAApB,IAAI,CAACC,UAAU,KACxB,IAAI,CAACA,UAAU,GAAG,EAAC,CAAA,CAAA;EAEvB,KAAA;EAzKA,qBACA,SALWZ,CAKJa,MAIN,GAJD,SAAcC,IAAI,EAAA;UAChB,OAAO,SAASC,KAAK,EAAEC,OAAO,EAAA;cANrBhB,SAOGiB,CAAAA,MAAM,CAACH,IAAAA,EAAMC,KAAOC,EAAAA,OAAAA,CAAAA,CAAAA;EAChC,SAAA,CAAA;OAGF,mBAXWhB,SAYJiB,CAAAA,MAEN,GAFD,SAAcH,IAAI,EAAEI,WAAW,EAAEF,OAAO,EAAA;EACtCG,QAAAA,cAAAA,CAAeF,MAAM,CAAC,IAAOH,GAAAA,IAAAA,EAAMI,WAAaF,EAAAA,OAAAA,CAAAA,CAAAA;EAClD,KAAA,EAAA,UAAA,GAAA;;cAKGI,GAAAA,EAAAA,QAAAA;;;QAAJ,WAAA;EACG,gBAAA,OAAOC,MAAOC,CAAAA,cAAc,CAAC,IAAI,EAAEJ,WAAW,CAAA;EAChD,aAAA;;;cAmBIK,GAAAA,EAAAA,eAAAA;EAAJ,YAAA,GAAA,EAAA,WAAA;kBACE,IAA2B,QAAvB,IAAI,CAACC,cAAc,EACrB,OAAO,IAAI,CAACA,cAAc,CAAA;;EAI5B,gBAAA,IAA4BH,oCAAtBI,EAAAA,mBAAAA,GAAsBJ,IAAAA,KAAAA,oCAAAA,GAAAA,MAAOC,CAAAA,cAAc,CAAC,IAAI,CAAEC,CAAAA,aAAa,CAAzCF,GAAAA,oCAAAA,GAA6C,EAAC,CAAA;EAM1E,gBAAA,OALA,IAAI,CAACG,cAAc,GAAG,aACjBC,mBACA,EAAA,IAAI,CAACP,WAAW,CAACK,aAAa,CAG5B,EAAA,IAAI,CAACC,cAAc,CAAA;EAC5B,aAAA;;;cAuCI9C,GAAAA,EAAAA,cAAAA;;;QAAJ,WAAA;EACE,gBAAA,IAAIA,YAAe,GAAA,IAAI,CAAC0C,MAAM,CAAC1C,YAAY,CAAA;EAQ3C,gBAAA,OALqB,QAAhBA,YAA0B,IAAA,IAAI,CAAC2B,QAAQ;mBAE1C3B,YAAAA,GAAe,CAAA,CAAG,CAGbA,EAAAA,YAAAA,CAAAA;EACT,aAAA;;;cAqBI2B,GAAAA,EAAAA,UAAAA;;;QAAJ,WAAA;EACE,gBAAA,OAAO,IAAI,CAACe,MAAM,CAACf,QAAQ,CAAA;EAC7B,aAAA;;EA7HWL,KAAAA,EAAAA,iBAAAA,CAAAA,SAAAA,CAAAA,SAAAA,EAAAA,UAAAA,CAAAA,EAAAA,SAAAA,EAAAA;IAAkB9J,aAiL9B,EAAA;EApHC,SAAA,aAAA,GAAA;MAMC,IAAMwL,UAAAA,GAAahH,oBAJhB,CAAI,IAAI,CAACiH,OAAO,IAAI,EAAE,CAAA,CAAA,MAAA,CACtB,qBAAI,IAAI,CAACjH,MAAM,IAAI,EAAE,GAGErB,GAAG,CAAC,SAAC0B,KAAO6G,EAAAA,KAAAA,EAAAA;UACnC,OAAO,QAAA,CAAA;cAACnF,EAAImF,EAAAA,KAAAA;EAAU7G,SAAAA,EAAAA,KAAAA,CAAAA,CAAAA;EACxB,KAAA,CAAA,CAAA;;EAGAsG,IAAAA,MAAAA,CAAOQ,cAAc,CAAC,IAAI,EAAE,QAAU,EAAA;EACrCC,QAAAA,YAAAA,EAAc,CAAA,CAAA;UACbrI,GAAAA,EAAAA,WAAAA;cACC,OAAOiI,UAAAA,CAAAA;EACR,SAAA;EACF,KAAA,CAAA,CAAA;EACF,CAAA;EA5CA;EAEA;EApCW1B,SAsCJuB,CAAAA,aAAAA,GAAgB,EAAC;EA4CxB;EAEA;;QApFWvB,SAAAA,CAuFJtB,YAAe,GAAA,IAAA;EAqBtB;EAEA;;;;;;;EAOC,MArHUsB,SAsHJK,CAAAA,QAAAA,GAAW,CAAA,CAAA;EA+DpBL,SAAU+B,CAAAA,cAAc,CAAC,SAACC,QAAAA,EAAAA;EACxB,IAAA,IAAMC,KAAQZ,GAAAA,MAAAA,CAAOC,cAAc,CAACU,UAAUd,WAAW,CAAA;MAEzD,IAA6B,KAAA,CAAA,KAAlBe,KAAMtK,CAAAA,OAAO,EACtB,IAAA,IAAA,KAAA,EAAA,SAAA,GAAA,oCAAA,CAAgC0J,MAAOa,CAAAA,OAAO,CAACD,KAAAA,CAAMtK,OAAO,CAAA,CAAA,EAAA,CAAA,CAAA,KAAA,GAAA,SAAA,EAAA,EAAA,IAAA,EAAA,CAAA,WAAA;EAE1BqJ,QAAAA,IAAAA,iBAAAA,EAAAA,WAAAA,GAAAA,KAAAA,CAAAA,KAAAA,EAFtBhG,MAAQgG,GAAAA,WAAAA,CAAAA,CAAAA,CAAAA,EAAAA,OAAAA,GAAAA,WAAAA,CAAAA,CAAAA,CAAAA,CAAAA;;UAElBK,MAAOQ,CAAAA,cAAc,CAACG,QAAUhB,EAAAA,IAAAA,KAAAA,oBAAAA,OAAQmB,CAAAA,QAAQ,CAAhBnB,GAAAA,iBAAAA,GAAoBhG,MAAQ,EAAA;EAC1D8G,YAAAA,YAAAA,EAAc,CAAA,CAAA;cACdrI,GAAAA,EAAAA,WAAAA;EAOE,gBAAA,IAN+B,KAAA,CAAA,KAApB,IAAI,CAACmH,UAAU,KACxB,IAAI,CAACA,UAAU,GAAG,EAAC,CAAA,EAKjBwB,CAFUpB,IAAAA,KAAAA,cAAAA,GAAAA,OAAAA,CAAQoB,KAAK,CAAA,IAAbpB,cAAoB,KAErB,IAAI,CAACJ,UAAU,CAAC5F,MAAAA,CAAO,EAClC,OAAO,IAAI,CAAC4F,UAAU,CAAC5F,MAAO,CAAA,CAAA;kBAE9B,IALYgG,cAAAA,EAKQ,gBAAhBqB,EAAAA,CAAAA,EAAAA,aAAAA,GAAgB,IAAA,KAAA,CAAA,GAAA,CAAA,gBAAA,GAAA,IAAI,CAACzB,UAAU,EAAC5F,MAAAA,CAAO,CAAvB,GAAA,CAAA,GAAA,gBAAe,CAACA,MAAO,CAAA,GAAK,IAAI,CAAC/D,UAAU,CAAC,IAAI,CAACb,OAAO,EAAE4E,MAAQgG,EAAAA,OAAAA,CAAQlK,QAAQ,CAAA,CAAA;kBAUtG,OATqB,QAAjBuL,aACF7B,GAAAA,OAAAA,CAAQ8B,KAAK,CAAE,iBAAcL,KAAMnB,CAAAA,IAAI,GAAC,aAAa9F,GAAAA,MAAAA,GAAO,mBAEpC,CAAsB,CAAA,CAArBgG,KAAAA,OAAAA,CAAQuB,QAAQ,IAAe,UAAwC,IAAvCF,cAAcjM,OAAO,CAACE,WAAW,EAAsB0K,IAAqB,CAAA,CAArBA,KAAAA,OAAAA,CAAQuB,QAAQ,MAE9HF,aAAgBG,GAAAA,kCAAAA,CAAgBH,cAAa,CAE/C,EAAA,IAAI,CAACzB,UAAU,CAAC5F,MAAO,CAAA,GAAGqH,aAErBA,CAAAA,EAAAA,aAAAA,CAAAA;EAEX,aAAA;EACF,SAAA,CAAA,CAAA;EACF,KAAA,EAAA,CAAA;MAGF,IAAgC,KAAA,CAAA,KAArBJ,KAAMQ,CAAAA,UAAU,EACzB,IAAA,IAAA,MAAA,EAAA,UAAA,GAAA,oCAAA,CAAgCpB,MAAOa,CAAAA,OAAO,CAACD,KAAAA,CAAMQ,UAAU,CAAA,CAAA,EAAA,CAAA,CAAA,MAAA,GAAA,UAAA,EAAA,EAAA,IAAA,EAAA,CAAA,WAAA;EAE7BzB,QAAAA,IAAAA,iBAAAA,EAAAA,WAAAA,GAAAA,MAAAA,CAAAA,KAAAA,EAFtBhG,MAAQgG,GAAAA,WAAAA,CAAAA,CAAAA,CAAAA,EAAAA,OAAAA,GAAAA,WAAAA,CAAAA,CAAAA,CAAAA,CAAAA;;UAElBK,MAAOQ,CAAAA,cAAc,CAACG,QAAUhB,EAAAA,IAAAA,KAAAA,oBAAAA,OAAQmB,CAAAA,QAAQ,CAAhBnB,GAAAA,iBAAAA,GAAoBhG,MAAQ,EAAA;EAC1D8G,YAAAA,YAAAA,EAAc,CAAA,CAAA;cACdrI,GAAAA,EAAAA,WAAAA;sBAKgBuH,cAKW,EAAA,mBAAA,EAAA,CAAA,CAAA;yBAHzB,CANkC,KAAA,CAAvB,KAAA,IAAI,CAAC0B,aAAa,KAC3B,IAAI,CAACA,aAAa,GAAG,EAAC,CAKpBN,EAFUpB,CAAAA,IAAAA,KAAAA,cAAAA,GAAAA,OAAAA,CAAQoB,KAAK,CAAA,IAAbpB,cAAoB,KAErB,IAAI,CAAC0B,aAAa,CAAC1H,MAAO,CAAA,IAC9B,IAAI,CAAC0H,aAAa,CAAC1H,MAAAA,CAAO,GAEV,IAAA,KAAA,CAAA,GAAA,CAAA,mBAAA,GAAA,IAAI,CAAC0H,aAAa,EAAC1H,MAAO,CAAA,CAAA,GAAA,CAAA,GAA1B,mBAAkB,CAACA,MAAO,CAAA,GAAK,IAAI,CAACtD,WAAW,CAAC,IAAI,CAACtB,OAAO,EAAE4E,MAAQgG,EAAAA,OAAAA,CAAQlK,QAAQ,CAAA,CAAA;;EAKjH,aAAA;EACF,SAAA,CAAA,CAAA;EACF,KAAA,EAAA,CAAA;EAEJ,CAAA,CAAA,CAAA;;;;;;ECpQA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EA6BC,IACM,SAASkE,MAAO,CAAA,KAAA,EAA0C2H,YAAmB,EAAA;EAA7D,IAAA,IAAA,OAAA,KAAA,CAAA,KAAA,KAAA,GAAsC,EAAC,GAAvC,OAAE7B,IAAF,GAAA,IAAA,CAAEA,IAAMhK,EAAAA,QAAAA,GAAR,KAAQA,QAAUsL,EAAAA,KAAAA,GAAlB,IAAkBA,CAAAA,KAAAA,EAAOG,WAAzB,IAAyBA,CAAAA,QAAAA,CAAAA;iBAAiBI,YAAAA,KAAAA,eAAe,IAAG,CAAA,CAAA;EACjF,IAAA,IAAM7G,OAAU,GAAA,SAASkG,QAAQ,EAAEG,QAAQ,EAAA;UACzC,IAAMF,KAAAA,GAAQD,SAASd,WAAW,CAAA;EAClC,QAAA,IAAI,CAAU,WAARc,CAAAA,QAAAA,EAAoBhC,SACxB,CAAA,EAAA,MAAM,KAAIpH,CAAM,yBAAC,GAAyBqJ,KAAMnB,CAAAA,IAAI,GAAC,qCAAA,CAAA,CAAA;EAG1B,QAAA,KAAA,MAAlBmB,KAAMtK,CAAAA,OAAO,KACtBsK,KAAAA,CAAMtK,OAAO,GAAG,EAAC,CAAA,EAEnBsK,MAAMtK,OAAO,CAACmJ,QAAAA,IAAAA,GAAAA,IAAAA,GAAQqB,SAAS,GAAG;cAACA,QAAAA,EAAAA,QAAAA;cAAUrL,QAAAA,EAAAA,QAAAA;cAAUsL,KAAAA,EAAAA,KAAAA;cAAOG,QAAAA,EAAAA,QAAAA;EAAQ,SAAA,CAAA;EACxE,KAAA,CAAA;MAEA,IAAoB,IAAhBI,IAAAA,YAAAA,EACF,OAAO7G,OAAAA,CAAAA;MAEP,IAAMkG,QAAAA,GAAWY,SAAS,CAAC,CAAE,CAAA,CAAA;EAC7B9G,IAAAA,OAAAA,CAAQkG,QAAUW,EAAAA,YAAAA,CAAAA,CAAAA;EAEtB,CAAA;EAEA;;;;;;;;;;;;;;;;;;;;;;;;EAwBC,IACM,SAAShL,OAAQ,CAAA,KAAA,EAAgCgL,YAAmB,EAAA;EAAnD,IAAA,IAAA,IAAA,GAAA,KAAA,CAAA,KAAA,KAA4B,GAAA,EAA5B,GAAA,KAAA,EAAE7B,IAAF,GAAA,IAAA,CAAEA,IAAMhK,EAAAA,QAAAA,GAAR,IAAQA,CAAAA,QAAAA,EAAUsL,QAAlB,IAAkBA,CAAAA,KAAAA,CAAAA;iBAAcO,YAAAA,KAAAA,eAAe,IAAG,CAAA,CAAA;EACxE,IAAA,IAAM7G,OAAU,GAAA,SAASkG,QAAQ,EAAEG,QAAQ,EAAA;UACzC,IAAMF,KAAAA,GAAQD,SAASd,WAAW,CAAA;EAClC,QAAA,IAAI,CAAU,WAARc,CAAAA,QAAAA,EAAoBhC,SACxB,CAAA,EAAA,MAAM,KAAIpH,CAAM,yBAAC,GAAyBqJ,KAAMnB,CAAAA,IAAI,GAAC,qCAAA,CAAA,CAAA;EAGvB,QAAA,KAAA,MAArBmB,KAAMQ,CAAAA,UAAU,KACzBR,KAAAA,CAAMQ,UAAU,GAAG,EAAC,CAAA,EAEtBR,MAAMQ,UAAU,CAAC3B,QAAAA,IAAAA,GAAAA,IAAAA,GAAQqB,SAAS,GAAG;cAACA,QAAAA,EAAAA,QAAAA;cAAUrL,QAAAA,EAAAA,QAAAA;cAAUsL,KAAAA,EAAAA,KAAAA;EAAK,SAAA,CAAA;EACjE,KAAA,CAAA;MAEA,IAAoB,IAAhBO,IAAAA,YAAAA,EACF,OAAO7G,OAAAA,CAAAA;MAEP,IAAMkG,QAAAA,GAAWY,SAAS,CAAC,CAAE,CAAA,CAAA;EAC7B9G,IAAAA,OAAAA,CAAQkG,QAAUW,EAAAA,YAAAA,CAAAA,CAAAA;EAEtB,CAAA;EAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAgCC,IACM,SAASE,OAAAA,CAAQ7H,MAAM,EAAED,KAAK,EAAE,KAAA,EAAA;EAAA,IAAA,IAAA,OAAA,KAAA,CAAA,KAAA,KAAA,GAA4C,EAAC,GAA7C,OAAEjE,QAAF,GAAA,IAAA,CAAEA,QAAUyB,EAAAA,QAAAA,GAAZ,KAAYA,QAAUR,EAAAA,QAAAA,GAAtB,IAAsBA,CAAAA,QAAAA,EAAU+D,UAAhC,IAAgCA,CAAAA,OAAAA,CAAAA;MACrE,OAAO,SAASkG,QAAQ,EAAEG,QAAQ,EAAA;UAChC,IAAMF,KAAAA,GAAQD,SAASd,WAAW,CAAA;EAClC,QAAA,IAAI,CAAU,WAARc,CAAAA,QAAAA,EAAoBhC,SACxB,CAAA,EAAA,MAAM,KAAIpH,CAAM,yBAAC,GAAyBqJ,KAAMnB,CAAAA,IAAI,GAAC,qCAAA,CAAA,CAAA;EAGvB,QAAA,KAAA,CAArBkB,KAAAA,QAAAA,CAASL,OAAO,KACzBK,QAASL,CAAAA,OAAO,GAAG,EAAE,CAGvBK,EAAAA,QAAAA,CAASL,OAAO,CAAC/J,IAAI,CAAC;cACpBoD,MAAAA,EAAAA,MAAAA;cACAb,OAAS6H,EAAAA,QAAQ,CAACG,QAAS,CAAA;cAC3BpH,KAAAA,EAAAA,KAAAA;cACAjE,QAAAA,EAAAA,QAAAA;cACAyB,QAAAA,EAAAA,QAAAA;cACAR,QAAAA,EAAAA,QAAAA;cACA+D,OAAAA,EAAAA,OAAAA;EACF,SAAA,CAAA,CAAA;EACF,KAAA,CAAA;EACF;;;;;;;;;;;"}